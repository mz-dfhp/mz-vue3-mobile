import{g as G,j as Be,n as X,t as $,k as fe,l as x,T as Oe,q as bt,s as De,v as _e,x as E,y as St,p as ve,f as Q,d as Z,z as Te,a as d,A as Je,C as Ct,D as pe,E as Ce,F as ze,i as ae,m as F,G as D,H as me,J as ge,K as Qe,L as pt,P as kt,M as It,N as Ae,O as Pt,Q as Ee,R as te,S as et,I as J,U as q,V as ne,W as xt,X as tt,Y as at,Z as Ot,$ as zt,a0 as ke,a1 as je,a2 as K,a3 as _t,a4 as Tt,a5 as de,a6 as Rt,a7 as Lt,a8 as Ue,a9 as $t,aa as Le,ab as At,ac as Se,ad as Bt,ae as ot,af as Dt,ag as nt,ah as lt,ai as Et,aj as it,ak as Ut,al as Mt,o as ce,c as ue,w as Xe,am as Fe,an as Ve,e as le,b as Yt,ao as jt,ap as Xt,aq as Ft,ar as Vt,_ as Nt}from"./index-30482789.js";import{L as Me}from"./index-fea92e77.js";function he(e){const a=Be();a&&G(a.proxy,e)}const Zt={show:Boolean,zIndex:X,overlay:$,duration:X,teleport:[String,Object],lockScroll:$,lazyRender:$,beforeClose:Function,overlayStyle:Object,overlayClass:fe,transitionAppear:Boolean,closeOnClickOverlay:$};function Ht(e,a){return e>a?"horizontal":a>e?"vertical":""}function Ye(){const e=x(0),a=x(0),o=x(0),t=x(0),l=x(0),n=x(0),v=x(""),f=x(!0),S=()=>v.value==="vertical",b=()=>v.value==="horizontal",s=()=>{o.value=0,t.value=0,l.value=0,n.value=0,v.value="",f.value=!0};return{move:i=>{const h=i.touches[0];o.value=(h.clientX<0?0:h.clientX)-e.value,t.value=h.clientY-a.value,l.value=Math.abs(o.value),n.value=Math.abs(t.value);const p=10;(!v.value||l.value<p&&n.value<p)&&(v.value=Ht(l.value,n.value)),f.value&&(l.value>Oe||n.value>Oe)&&(f.value=!1)},start:i=>{s(),e.value=i.touches[0].clientX,a.value=i.touches[0].clientY},reset:s,startX:e,startY:a,deltaX:o,deltaY:t,offsetX:l,offsetY:n,direction:v,isVertical:S,isHorizontal:b,isTap:f}}let we=0;const Ne="van-overflow-hidden";function Wt(e,a){const o=Ye(),t="01",l="10",n=s=>{o.move(s);const u=o.deltaY.value>0?l:t,g=St(s.target,e.value),{scrollHeight:i,offsetHeight:h,scrollTop:p}=g;let c="11";p===0?c=h>=i?"00":"01":p+h>=i&&(c="10"),c!=="11"&&o.isVertical()&&!(parseInt(c,2)&parseInt(u,2))&&ve(s,!0)},v=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",n,{passive:!1}),we||document.body.classList.add(Ne),we++},f=()=>{we&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",n),we--,we||document.body.classList.remove(Ne))},S=()=>a()&&v(),b=()=>a()&&f();bt(S),De(b),_e(b),E(a,s=>{s?v():f()})}function st(e){const a=x(!1);return E(e,o=>{o&&(a.value=o)},{immediate:!0}),o=>()=>a.value?o():null}const[Kt,Gt]=Q("overlay"),qt={show:Boolean,zIndex:X,duration:X,className:fe,lockScroll:$,lazyRender:$,customStyle:Object};var Jt=Z({name:Kt,props:qt,setup(e,{slots:a}){const o=x(),t=st(()=>e.show||!e.lazyRender),l=v=>{e.lockScroll&&ve(v,!0)},n=t(()=>{var v;const f=G(Ct(e.zIndex),e.customStyle);return pe(e.duration)&&(f.animationDuration=`${e.duration}s`),Ce(d("div",{ref:o,style:f,class:[Gt(),e.className]},[(v=a.default)==null?void 0:v.call(a)]),[[ze,e.show]])});return Te("touchmove",l,{target:o}),()=>d(Je,{name:"van-fade",appear:!0},{default:n})}});const Qt=ae(Jt),ea=G({},Zt,{round:Boolean,position:F("center"),closeIcon:F("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:F("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[ta,Ze]=Q("popup");var aa=Z({name:ta,inheritAttrs:!1,props:ea,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:a,attrs:o,slots:t}){let l,n;const v=x(),f=x(),S=st(()=>e.show||!e.lazyRender),b=D(()=>{const r={zIndex:v.value};if(pe(e.duration)){const C=e.position==="center"?"animationDuration":"transitionDuration";r[C]=`${e.duration}s`}return r}),s=()=>{l||(l=!0,v.value=e.zIndex!==void 0?+e.zIndex:Pt(),a("open"))},u=()=>{l&&Ee(e.beforeClose,{done(){l=!1,a("close"),a("update:show",!1)}})},g=r=>{a("clickOverlay",r),e.closeOnClickOverlay&&u()},i=()=>{if(e.overlay)return d(Qt,{show:e.show,class:e.overlayClass,zIndex:v.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:g},{default:t["overlay-content"]})},h=r=>{a("clickCloseIcon",r),u()},p=()=>{if(e.closeable)return d(J,{role:"button",tabindex:0,name:e.closeIcon,class:[Ze("close-icon",e.closeIconPosition),et],classPrefix:e.iconPrefix,onClick:h},null)};let c;const y=()=>{c&&clearTimeout(c),c=setTimeout(()=>{a("opened")})},k=()=>a("closed"),T=r=>a("keydown",r),_=S(()=>{var r;const{round:C,position:O,safeAreaInsetTop:z,safeAreaInsetBottom:U}=e;return Ce(d("div",te({ref:f,style:b.value,role:"dialog",tabindex:0,class:[Ze({round:C,[O]:O}),{"van-safe-area-top":z,"van-safe-area-bottom":U}],onKeydown:T},o),[(r=t.default)==null?void 0:r.call(t),p()]),[[ze,e.show]])}),R=()=>{const{position:r,transition:C,transitionAppear:O}=e,z=r==="center"?"van-fade":`van-popup-slide-${r}`;return d(Je,{name:C||z,appear:O,onAfterEnter:y,onAfterLeave:k},{default:_})};return E(()=>e.show,r=>{r&&!l&&(s(),o.tabindex===0&&me(()=>{var C;(C=f.value)==null||C.focus()})),!r&&l&&(l=!1,a("close"))}),he({popupRef:f}),Wt(f,()=>e.show&&e.lockScroll),Te("popstate",()=>{e.closeOnPopstate&&(u(),n=!1)}),ge(()=>{e.show&&s()}),Qe(()=>{n&&(a("update:show",!0),n=!1)}),De(()=>{e.show&&e.teleport&&(u(),n=!0)}),pt(kt,()=>e.show),()=>e.teleport?d(It,{to:e.teleport},{default:()=>[i(),R()]}):d(Ae,null,[i(),R()])}});const rt=ae(aa),[ct,Ie]=Q("swipe"),oa={loop:$,width:X,height:X,vertical:Boolean,autoplay:q(0),duration:q(500),touchable:$,lazyRender:Boolean,initialSwipe:q(0),indicatorColor:String,showIndicators:$,stopPropagation:$},ut=Symbol(ct);var na=Z({name:ct,props:oa,emits:["change","dragStart","dragEnd"],setup(e,{emit:a,slots:o}){const t=x(),l=x(),n=ne({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let v=!1;const f=Ye(),{children:S,linkChildren:b}=xt(ut),s=D(()=>S.length),u=D(()=>n[e.vertical?"height":"width"]),g=D(()=>e.vertical?f.deltaY.value:f.deltaX.value),i=D(()=>n.rect?(e.vertical?n.rect.height:n.rect.width)-u.value*s.value:0),h=D(()=>u.value?Math.ceil(Math.abs(i.value)/u.value):s.value),p=D(()=>s.value*u.value),c=D(()=>(n.active+s.value)%s.value),y=D(()=>{const w=e.vertical?"vertical":"horizontal";return f.direction.value===w}),k=D(()=>{const w={transitionDuration:`${n.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${n.offset}px)`};if(u.value){const L=e.vertical?"height":"width",A=e.vertical?"width":"height";w[L]=`${p.value}px`,w[A]=e[A]?`${e[A]}px`:""}return w}),T=w=>{const{active:L}=n;return w?e.loop?K(L+w,-1,s.value):K(L+w,0,h.value):L},_=(w,L=0)=>{let A=w*u.value;e.loop||(A=Math.min(A,-i.value));let N=L-A;return e.loop||(N=K(N,i.value,0)),N},R=({pace:w=0,offset:L=0,emitChange:A})=>{if(s.value<=1)return;const{active:N}=n,V=T(w),ye=_(V,L);if(e.loop){if(S[0]&&ye!==i.value){const Re=ye<i.value;S[0].setOffset(Re?p.value:0)}if(S[s.value-1]&&ye!==0){const Re=ye>0;S[s.value-1].setOffset(Re?-p.value:0)}}n.active=V,n.offset=ye,A&&V!==N&&a("change",c.value)},r=()=>{n.swiping=!0,n.active<=-1?R({pace:s.value}):n.active>=s.value&&R({pace:-s.value})},C=()=>{r(),f.reset(),ke(()=>{n.swiping=!1,R({pace:-1,emitChange:!0})})},O=()=>{r(),f.reset(),ke(()=>{n.swiping=!1,R({pace:1,emitChange:!0})})};let z;const U=()=>clearTimeout(z),Y=()=>{U(),+e.autoplay>0&&s.value>1&&(z=setTimeout(()=>{O(),Y()},+e.autoplay))},H=(w=+e.initialSwipe)=>{if(!t.value)return;const L=()=>{var A,N;if(!je(t)){const V={width:t.value.offsetWidth,height:t.value.offsetHeight};n.rect=V,n.width=+((A=e.width)!=null?A:V.width),n.height=+((N=e.height)!=null?N:V.height)}s.value&&(w=Math.min(s.value-1,w),w===-1&&(w=s.value-1)),n.active=w,n.swiping=!0,n.offset=_(w),S.forEach(V=>{V.setOffset(0)}),Y()};je(t)?me().then(L):L()},ee=()=>H(n.active);let oe;const m=w=>{!e.touchable||w.touches.length>1||(f.start(w),v=!1,oe=Date.now(),U(),r())},I=w=>{e.touchable&&n.swiping&&(f.move(w),y.value&&(!e.loop&&(n.active===0&&g.value>0||n.active===s.value-1&&g.value<0)||(ve(w,e.stopPropagation),R({offset:g.value}),v||(a("dragStart",{index:c.value}),v=!0))))},P=()=>{if(!e.touchable||!n.swiping)return;const w=Date.now()-oe,L=g.value/w;if((Math.abs(L)>.25||Math.abs(g.value)>u.value/2)&&y.value){const N=e.vertical?f.offsetY.value:f.offsetX.value;let V=0;e.loop?V=N>0?g.value>0?-1:1:0:V=-Math[g.value>0?"ceil":"floor"](g.value/u.value),R({pace:V,emitChange:!0})}else g.value&&R({pace:0});v=!1,n.swiping=!1,a("dragEnd",{index:c.value}),Y()},M=(w,L={})=>{r(),f.reset(),ke(()=>{let A;e.loop&&w===s.value?A=n.active===0?0:w:A=w%s.value,L.immediate?ke(()=>{n.swiping=!1}):n.swiping=!1,R({pace:A-n.active,emitChange:!0})})},j=(w,L)=>{const A=L===c.value,N=A?{backgroundColor:e.indicatorColor}:void 0;return d("i",{style:N,class:Ie("indicator",{active:A})},null)},W=()=>{if(o.indicator)return o.indicator({active:c.value,total:s.value});if(e.showIndicators&&s.value>1)return d("div",{class:Ie("indicators",{vertical:e.vertical})},[Array(s.value).fill("").map(j)])};return he({prev:C,next:O,state:n,resize:ee,swipeTo:M}),b({size:u,props:e,count:s,activeIndicator:c}),E(()=>e.initialSwipe,w=>H(+w)),E(s,()=>H(n.active)),E(()=>e.autoplay,Y),E([tt,at,()=>e.width,()=>e.height],ee),E(Ot(),w=>{w==="visible"?Y():U()}),ge(H),Qe(()=>H(n.active)),zt(()=>H(n.active)),De(U),_e(U),Te("touchmove",I,{target:l}),()=>{var w;return d("div",{ref:t,class:Ie()},[d("div",{ref:l,style:k.value,class:Ie("track",{vertical:e.vertical}),onTouchstartPassive:m,onTouchend:P,onTouchcancel:P},[(w=o.default)==null?void 0:w.call(o)]),W()])}}});const la=ae(na),[ia,sa]=Q("swipe-item");var ra=Z({name:ia,setup(e,{slots:a}){let o;const t=ne({offset:0,inited:!1,mounted:!1}),{parent:l,index:n}=_t(ut);if(!l)return;const v=D(()=>{const b={},{vertical:s}=l.props;return l.size.value&&(b[s?"height":"width"]=`${l.size.value}px`),t.offset&&(b.transform=`translate${s?"Y":"X"}(${t.offset}px)`),b}),f=D(()=>{const{loop:b,lazyRender:s}=l.props;if(!s||o)return!0;if(!t.mounted)return!1;const u=l.activeIndicator.value,g=l.count.value-1,i=u===0&&b?g:u-1,h=u===g&&b?0:u+1;return o=n.value===u||n.value===i||n.value===h,o}),S=b=>{t.offset=b};return ge(()=>{me(()=>{t.mounted=!0})}),he({setOffset:S}),()=>{var b;return d("div",{class:sa(),style:v.value},[f.value?(b=a.default)==null?void 0:b.call(a):null])}}});const ca=ae(ra);let be=0;function ua(e){e?(be||document.body.classList.add("van-toast--unclickable"),be++):be&&(be--,be||document.body.classList.remove("van-toast--unclickable"))}const[da,ie]=Q("toast"),va=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],fa={icon:String,show:Boolean,type:F("text"),overlay:Boolean,message:X,iconSize:X,duration:Rt(2e3),position:F("middle"),teleport:[String,Object],wordBreak:String,className:fe,iconPrefix:String,transition:F("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:fe,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var dt=Z({name:da,props:fa,emits:["update:show"],setup(e,{emit:a,slots:o}){let t,l=!1;const n=()=>{const u=e.show&&e.forbidClick;l!==u&&(l=u,ua(l))},v=u=>a("update:show",u),f=()=>{e.closeOnClick&&v(!1)},S=()=>clearTimeout(t),b=()=>{const{icon:u,type:g,iconSize:i,iconPrefix:h,loadingType:p}=e;if(u||g==="success"||g==="fail")return d(J,{name:u||g,size:i,class:ie("icon"),classPrefix:h},null);if(g==="loading")return d(Me,{class:ie("loading"),size:i,type:p},null)},s=()=>{const{type:u,message:g}=e;if(o.message)return d("div",{class:ie("text")},[o.message()]);if(pe(g)&&g!=="")return u==="html"?d("div",{key:0,class:ie("text"),innerHTML:String(g)},null):d("div",{class:ie("text")},[g])};return E(()=>[e.show,e.forbidClick],n),E(()=>[e.show,e.type,e.message,e.duration],()=>{S(),e.show&&e.duration>0&&(t=setTimeout(()=>{v(!1)},e.duration))}),ge(n),Tt(n),()=>d(rt,te({class:[ie([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:f,onClosed:S,"onUpdate:show":v},de(e,va)),{default:()=>[b(),s()]})}});function vt(){const e=ne({show:!1}),a=l=>{e.show=l},o=l=>{G(e,l,{transitionAppear:!0}),a(!0)},t=()=>a(!1);return he({open:o,close:t,toggle:a}),{open:o,close:t,state:e,toggle:a}}function ft(e){const a=Lt(e),o=document.createElement("div");return document.body.appendChild(o),{instance:a.mount(o),unmount(){a.unmount(),document.body.removeChild(o)}}}const ma={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let Pe=[],ga=!1,He=G({},ma);const ha=new Map;function ya(e){return $t(e)?e:{message:e}}function wa(){const{instance:e,unmount:a}=ft({setup(){const o=x(""),{open:t,state:l,close:n,toggle:v}=vt(),f=()=>{},S=()=>d(dt,te(l,{onClosed:f,"onUpdate:show":v}),null);return E(o,b=>{l.message=b}),Be().render=S,{open:t,close:n,message:o}}});return e}function ba(){if(!Pe.length||ga){const e=wa();Pe.push(e)}return Pe[Pe.length-1]}function We(e={}){if(!Ue)return{};const a=ba(),o=ya(e);return a.open(G({},He,ha.get(o.type||He.type),o)),a}ae(dt);const[Sa,se]=Q("image"),Ca={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:X,height:X,radius:X,lazyLoad:Boolean,iconSize:X,showError:$,errorIcon:F("photo-fail"),iconPrefix:String,showLoading:$,loadingIcon:F("photo")};var pa=Z({name:Sa,props:Ca,emits:["load","error"],setup(e,{emit:a,slots:o}){const t=x(!1),l=x(!0),n=x(),{$Lazyload:v}=Be().proxy,f=D(()=>{const c={width:Le(e.width),height:Le(e.height)};return pe(e.radius)&&(c.overflow="hidden",c.borderRadius=Le(e.radius)),c});E(()=>e.src,()=>{t.value=!1,l.value=!0});const S=c=>{l.value&&(l.value=!1,a("load",c))},b=()=>{const c=new Event("load");Object.defineProperty(c,"target",{value:n.value,enumerable:!0}),S(c)},s=c=>{t.value=!0,l.value=!1,a("error",c)},u=(c,y,k)=>k?k():d(J,{name:c,size:e.iconSize,class:y,classPrefix:e.iconPrefix},null),g=()=>{if(l.value&&e.showLoading)return d("div",{class:se("loading")},[u(e.loadingIcon,se("loading-icon"),o.loading)]);if(t.value&&e.showError)return d("div",{class:se("error")},[u(e.errorIcon,se("error-icon"),o.error)])},i=()=>{if(t.value||!e.src)return;const c={alt:e.alt,class:se("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?Ce(d("img",te({ref:n},c),null),[[At("lazy"),e.src]]):d("img",te({ref:n,src:e.src,onLoad:S,onError:s},c),null)},h=({el:c})=>{const y=()=>{c===n.value&&l.value&&b()};n.value?y():me(y)},p=({el:c})=>{c===n.value&&!t.value&&s()};return v&&Ue&&(v.$on("loaded",h),v.$on("error",p),_e(()=>{v.$off("loaded",h),v.$off("error",p)})),ge(()=>{me(()=>{var c;(c=n.value)!=null&&c.complete&&!e.lazyLoad&&b()})}),()=>{var c;return d("div",{class:se({round:e.round,block:e.block}),style:f.value},[i(),g(),(c=o.default)==null?void 0:c.call(o)])}}});const mt=ae(pa),Ke=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),ka=e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}),$e=Q("image-preview")[1],Ge=2.6;var Ia=Z({props:{src:String,show:Boolean,active:Number,minZoom:Se(X),maxZoom:Se(X),rootWidth:Se(Number),rootHeight:Se(Number),disableZoom:Boolean,closeOnClickOverlay:Boolean},emits:["scale","close","longPress"],setup(e,{emit:a,slots:o}){const t=ne({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),l=Ye(),n=x(),v=x(),f=x(!1),S=x(!1);let b=0;const s=D(()=>{const{scale:m,moveX:I,moveY:P,moving:M,zooming:j,initializing:W}=t,w={transitionDuration:j||M||W?"0s":".3s"};return(m!==1||S.value)&&(w.transform=`matrix(${m}, 0, 0, ${m}, ${I}, ${P})`),w}),u=D(()=>{if(t.imageRatio){const{rootWidth:m,rootHeight:I}=e,P=f.value?I/t.imageRatio:m;return Math.max(0,(t.scale*P-m)/2)}return 0}),g=D(()=>{if(t.imageRatio){const{rootWidth:m,rootHeight:I}=e,P=f.value?I:m*t.imageRatio;return Math.max(0,(t.scale*P-I)/2)}return 0}),i=(m,I)=>{var P;if(m=K(m,+e.minZoom,+e.maxZoom+1),m!==t.scale){const M=m/t.scale;if(t.scale=m,I){const j=ot((P=n.value)==null?void 0:P.$el),W={x:j.width*.5,y:j.height*.5},w=t.moveX-(I.x-j.left-W.x)*(M-1),L=t.moveY-(I.y-j.top-W.y)*(M-1);t.moveX=K(w,-u.value,u.value),t.moveY=K(L,-g.value,g.value)}else t.moveX=0,t.moveY=S.value?b:0;a("scale",{scale:m,index:e.active})}},h=()=>{i(1)},p=()=>{const m=t.scale>1?1:2;i(m,m===2||S.value?{x:l.startX.value,y:l.startY.value}:void 0)};let c,y,k,T,_,R,r,C,O=!1;const z=m=>{const{touches:I}=m;if(c=I.length,c===2&&e.disableZoom)return;const{offsetX:P}=l;l.start(m),y=t.moveX,k=t.moveY,C=Date.now(),O=!1,t.moving=c===1&&(t.scale!==1||S.value),t.zooming=c===2&&!P.value,t.zooming&&(T=t.scale,_=Ke(I))},U=m=>{const{touches:I}=m;if(l.move(m),t.moving){const{deltaX:P,deltaY:M}=l,j=P.value+y,W=M.value+k;if((j>u.value||j<-u.value)&&!O&&l.isHorizontal()){t.moving=!1;return}O=!0,ve(m,!0),t.moveX=K(j,-u.value,u.value),t.moveY=K(W,-g.value,g.value)}if(t.zooming&&(ve(m,!0),I.length===2)){const P=Ke(I),M=T*P/_;R=ka(I),i(M,R)}},Y=m=>{var I;if(c>1)return;const{offsetX:P,offsetY:M}=l,j=Date.now()-C,W=250;if(P.value<Oe&&M.value<Oe)if(j<W)if(r)clearTimeout(r),r=null,p();else{if(!e.closeOnClickOverlay&&m.target===((I=v.value)==null?void 0:I.$el))return;r=setTimeout(()=>{a("close"),r=null},W)}else j>Dt&&a("longPress")},H=m=>{let I=!1;if((t.moving||t.zooming)&&(I=!0,t.moving&&y===t.moveX&&k===t.moveY&&(I=!1),!m.touches.length)){t.zooming&&(t.moveX=K(t.moveX,-u.value,u.value),t.moveY=K(t.moveY,-g.value,g.value),t.zooming=!1),t.moving=!1,y=0,k=0,T=1,t.scale<1&&h();const P=+e.maxZoom;t.scale>P&&i(P,R)}ve(m,I),Y(m),l.reset()},ee=()=>{const{rootWidth:m,rootHeight:I}=e,P=I/m,{imageRatio:M}=t;f.value=t.imageRatio>P&&M<Ge,S.value=t.imageRatio>P&&M>=Ge,S.value&&(b=(M*m-I)/2,t.moveY=b,t.initializing=!0,Bt(()=>{t.initializing=!1})),h()},oe=m=>{const{naturalWidth:I,naturalHeight:P}=m.target;t.imageRatio=P/I,ee()};return E(()=>e.active,h),E(()=>e.show,m=>{m||h()}),E(()=>[e.rootWidth,e.rootHeight],ee),Te("touchmove",U,{target:D(()=>{var m;return(m=v.value)==null?void 0:m.$el})}),()=>{const m={loading:()=>d(Me,{type:"spinner"},null)};return d(ca,{ref:v,class:$e("swipe-item"),onTouchstartPassive:z,onTouchend:H,onTouchcancel:H},{default:()=>[o.image?d("div",{class:$e("image-wrap")},[o.image({src:e.src})]):d(mt,{ref:n,src:e.src,fit:"contain",class:$e("image",{vertical:f.value}),style:s.value,onLoad:oe},m)]})}}});const[Pa,re]=Q("image-preview"),xa=["show","teleport","transition","overlayStyle","closeOnPopstate"],Oa={show:Boolean,loop:$,images:nt(),minZoom:q(1/3),maxZoom:q(3),overlay:$,closeable:Boolean,showIndex:$,className:fe,closeIcon:F("clear"),transition:String,beforeClose:Function,overlayClass:fe,overlayStyle:Object,swipeDuration:q(300),startPosition:q(0),showIndicators:Boolean,closeOnPopstate:$,closeOnClickOverlay:$,closeIconPosition:F("top-right"),teleport:[String,Object]};var gt=Z({name:Pa,props:Oa,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:a,slots:o}){const t=x(),l=ne({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),n=()=>{if(t.value){const k=ot(t.value.$el);l.rootWidth=k.width,l.rootHeight=k.height,t.value.resize()}},v=k=>a("scale",k),f=k=>a("update:show",k),S=()=>{Ee(e.beforeClose,{args:[l.active],done:()=>f(!1)})},b=k=>{k!==l.active&&(l.active=k,a("change",k))},s=()=>{if(e.showIndex)return d("div",{class:re("index")},[o.index?o.index({index:l.active}):`${l.active+1} / ${e.images.length}`])},u=()=>{if(o.cover)return d("div",{class:re("cover")},[o.cover()])},g=()=>{l.disableZoom=!0},i=()=>{l.disableZoom=!1},h=()=>d(la,{ref:t,lazyRender:!0,loop:e.loop,class:re("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:b,onDragEnd:i,onDragStart:g},{default:()=>[e.images.map((k,T)=>d(Ia,{src:k,show:e.show,active:l.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:l.rootWidth,rootHeight:l.rootHeight,disableZoom:l.disableZoom,closeOnClickOverlay:e.closeOnClickOverlay,onScale:v,onClose:S,onLongPress:()=>a("longPress",{index:T})},{image:o.image}))]}),p=()=>{if(e.closeable)return d(J,{role:"button",name:e.closeIcon,class:[re("close-icon",e.closeIconPosition),et],onClick:S},null)},c=()=>a("closed"),y=(k,T)=>{var _;return(_=t.value)==null?void 0:_.swipeTo(k,T)};return he({swipeTo:y}),ge(n),E([tt,at],n),E(()=>e.startPosition,k=>b(+k)),E(()=>e.show,k=>{const{images:T,startPosition:_}=e;k?(b(+_),me(()=>{n(),y(+_,{immediate:!0})})):a("close",{index:l.active,url:T[l.active]})}),()=>d(rt,te({class:[re(),e.className],overlayClass:[re("overlay"),e.overlayClass],onClosed:c,"onUpdate:show":f},de(e,xa)),{default:()=>[p(),h(),s(),u()]})}});let xe;const za={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function _a(){({instance:xe}=ft({setup(){const{state:e,toggle:a}=vt(),o=()=>{e.images=[]};return()=>d(gt,te(e,{onClosed:o,"onUpdate:show":a}),null)}}))}const ht=(e,a=0)=>{if(Ue)return xe||_a(),e=Array.isArray(e)?{images:e,startPosition:a}:e,xe.open(G({},za,e)),xe};ae(gt);const[Ta,B,Ra]=Q("uploader");function qe(e,a){return new Promise(o=>{if(a==="file"){o();return}const t=new FileReader;t.onload=l=>{o(l.target.result)},a==="dataUrl"?t.readAsDataURL(e):a==="text"&&t.readAsText(e)})}function yt(e,a){return lt(e).some(o=>o.file?Et(a)?a(o.file):o.file.size>+a:!1)}function La(e,a){const o=[],t=[];return e.forEach(l=>{yt(l,a)?t.push(l):o.push(l)}),{valid:o,invalid:t}}const $a=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,Aa=e=>$a.test(e);function wt(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?Aa(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var Ba=Z({props:{name:X,item:Se(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:a,slots:o}){const t=()=>{const{status:s,message:u}=e.item;if(s==="uploading"||s==="failed"){const g=s==="failed"?d(J,{name:"close",class:B("mask-icon")},null):d(Me,{class:B("loading")},null),i=pe(u)&&u!=="";return d("div",{class:B("mask")},[g,i&&d("div",{class:B("mask-message")},[u])])}},l=s=>{const{name:u,item:g,index:i,beforeDelete:h}=e;s.stopPropagation(),Ee(h,{args:[g,{name:u,index:i}],done:()=>a("delete")})},n=()=>a("preview"),v=()=>a("reupload"),f=()=>{if(e.deletable&&e.item.status!=="uploading"){const s=o["preview-delete"];return d("div",{role:"button",class:B("preview-delete",{shadow:!s}),tabindex:0,"aria-label":Ra("delete"),onClick:l},[s?s():d(J,{name:"cross",class:B("preview-delete-icon")},null)])}},S=()=>{if(o["preview-cover"]){const{index:s,item:u}=e;return d("div",{class:B("preview-cover")},[o["preview-cover"](G({index:s},u))])}},b=()=>{const{item:s,lazyLoad:u,imageFit:g,previewSize:i,reupload:h}=e;return wt(s)?d(mt,{fit:g,src:s.objectUrl||s.content||s.url,class:B("preview-image"),width:Array.isArray(i)?i[0]:i,height:Array.isArray(i)?i[1]:i,lazyLoad:u,onClick:h?v:n},{default:S}):d("div",{class:B("file"),style:it(e.previewSize)},[d(J,{class:B("file-icon"),name:"description"},null),d("div",{class:[B("file-name"),"van-ellipsis"]},[s.file?s.file.name:s.url]),S()])};return()=>d("div",{class:B("preview")},[b(),t(),f()])}});const Da={name:q(""),accept:F("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:q(1/0),imageFit:F("cover"),resultType:F("dataUrl"),uploadIcon:F("photograph"),uploadText:String,deletable:$,reupload:Boolean,afterRead:Function,showUpload:$,modelValue:nt(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:$,previewOptions:Object,previewFullImage:$,maxSize:{type:[Number,String,Function],default:1/0}};var Ea=Z({name:Ta,props:Da,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:a,slots:o}){const t=x(),l=[],n=x(-1),v=(r=e.modelValue.length)=>({name:e.name,index:r}),f=()=>{t.value&&(t.value.value="")},S=r=>{if(f(),yt(r,e.maxSize))if(Array.isArray(r)){const C=La(r,e.maxSize);if(r=C.valid,a("oversize",C.invalid,v()),!r.length)return}else{a("oversize",r,v());return}if(r=ne(r),n.value>-1){const C=[...e.modelValue];C.splice(n.value,1,r),a("update:modelValue",C),n.value=-1}else a("update:modelValue",[...e.modelValue,...lt(r)]);e.afterRead&&e.afterRead(r,v())},b=r=>{const{maxCount:C,modelValue:O,resultType:z}=e;if(Array.isArray(r)){const U=+C-O.length;r.length>U&&(r=r.slice(0,U)),Promise.all(r.map(Y=>qe(Y,z))).then(Y=>{const H=r.map((ee,oe)=>{const m={file:ee,status:"",message:"",objectUrl:URL.createObjectURL(ee)};return Y[oe]&&(m.content=Y[oe]),m});S(H)})}else qe(r,z).then(U=>{const Y={file:r,status:"",message:"",objectUrl:URL.createObjectURL(r)};U&&(Y.content=U),S(Y)})},s=r=>{const{files:C}=r.target;if(e.disabled||!C||!C.length)return;const O=C.length===1?C[0]:[].slice.call(C);if(e.beforeRead){const z=e.beforeRead(O,v());if(!z){f();return}if(Mt(z)){z.then(U=>{b(U||O)}).catch(f);return}}b(O)};let u;const g=()=>a("closePreview"),i=r=>{if(e.previewFullImage){const C=e.modelValue.filter(wt),O=C.map(z=>(z.objectUrl&&!z.url&&z.status!=="failed"&&(z.url=z.objectUrl,l.push(z.url)),z.url)).filter(Boolean);u=ht(G({images:O,startPosition:C.indexOf(r),onClose:g},e.previewOptions))}},h=()=>{u&&u.close()},p=(r,C)=>{const O=e.modelValue.slice(0);O.splice(C,1),a("update:modelValue",O),a("delete",r,v(C))},c=r=>{R(),n.value=r},y=(r,C)=>{const O=["imageFit","deletable","reupload","previewSize","beforeDelete"],z=G(de(e,O),de(r,O,!0));return d(Ba,te({item:r,index:C,onClick:()=>a(e.reupload?"clickReupload":"clickPreview",r,v(C)),onDelete:()=>p(r,C),onPreview:()=>i(r),onReupload:()=>c(C)},de(e,["name","lazyLoad"]),z),de(o,["preview-cover","preview-delete"]))},k=()=>{if(e.previewImage)return e.modelValue.map(y)},T=r=>a("clickUpload",r),_=()=>{if(e.modelValue.length>=+e.maxCount&&!e.reupload)return;const r=e.modelValue.length>=+e.maxCount&&e.reupload,C=e.readonly?null:d("input",{ref:t,type:"file",class:B("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&n.value===-1,disabled:e.disabled,onChange:s},null);return o.default?Ce(d("div",{class:B("input-wrapper"),onClick:T},[o.default(),C]),[[ze,!r]]):Ce(d("div",{class:B("upload",{readonly:e.readonly}),style:it(e.previewSize),onClick:T},[d(J,{name:e.uploadIcon,class:B("upload-icon")},null),e.uploadText&&d("span",{class:B("upload-text")},[e.uploadText]),C]),[[ze,e.showUpload&&!r]])},R=()=>{t.value&&!e.disabled&&t.value.click()};return _e(()=>{l.forEach(r=>URL.revokeObjectURL(r))}),he({chooseFile:R,closeImagePreview:h}),Ut(()=>e.modelValue),()=>d("div",{class:B()},[d("div",{class:B("wrapper",{disabled:e.disabled})},[k(),_()])])}});const Ua=ae(Ea);const Ma=["src","onClick"],Ya={key:1,controls:"",class:"upload-image"},ja=["src"],Xa=["src"],Fa=["onClick"],Va={class:"upload-empty"},Na={class:"empty-box"},Za={class:"empty-text"},Ha=Z({__name:"index",props:{fileStr:{default:""},isPreview:{type:Boolean,default:!1},emptyTitle:{default:"上传"},limit:{default:9},fileSize:{default:12},fileType:{default:()=>["image/jpeg","image/jpg","image/png","image/gif"]},isUploadVideo:{type:Boolean,default:!1},height:{default:90},width:{default:90},margin:{default:8},borderRadius:{default:8}},emits:["update:fileStr"],setup(e,{emit:a}){const o=e,t=D(()=>{const i=["video/mp4","video/m2v","video/mkv","video/mov","video/3gp","video/quicktime"];return o.isUploadVideo?o.fileType.concat(i):o.fileType}),l=D(()=>{const i=h=>`${h/375*100}vw`;return{"--width":i(o.width),"--height":i(o.height),"--borderRadius":i(o.borderRadius),"--margin":i(o.margin)}}),n=x([]),v=["png","jpg","jpeg","bmp","gif"],f=["mp4","m2v","mkv","mov","3gp"];function S(i=""){var p;const h=((p=i.split(".").pop())==null?void 0:p.toLocaleLowerCase())||"";return v.includes(h)?"image":f.includes(h)?"video":""}function b(i){const h=Array.isArray(i)?i:[i],p=n.value.length,c=h.slice(0,o.limit-p).map(y=>new Promise((k,T)=>{const{size:_,type:R}=y;_/1024/1024>o.fileSize&&(We(`上传图片大小不能超过 ${o.fileSize}M！`),T(new Error(`上传图片大小不能超过 ${o.fileSize}M！`))),t.value.includes(R.toLocaleLowerCase())||(We("上传文件不符合所需的格式！"),T(new Error("上传文件不符合所需的格式！"))),k(y)}));return Promise.all(c)}async function s(i){const p=i.map(c=>({...c})).map((c,y)=>new Promise(async(k,T)=>{try{i[y].status="uploading",i[y].message="上传中...";const _=new FormData;_.append("file",c.file),_.append("module","efficacy"),_.append("category","track"),_.append("async","false");const{data:{absoluteUrl:R}}=await Promise.resolve({data:{absoluteUrl:"https://fastly.jsdelivr.net/npm/@vant/assets/leaf.jpeg"}});i[y].status="done",i[y].message="上传成功",i[y].url=R,k({absoluteUrl:R})}catch(_){console.log(_),i[y].status="failed",i[y].message="上传失败",T(new Error("上传失败"))}}));try{await Promise.all(p)}catch{a("update:fileStr","")}finally{const c=n.value.filter(y=>!!y.url).map(y=>y.url).join(",");a("update:fileStr",c)}}function u(i){const h=n.value.filter(p=>p.url!==i).map(p=>p.url).join(",");a("update:fileStr",h)}function g(i){let h=-1;const p=n.value.map((c,y)=>(c.url===i&&(h=y),c.url));ht({images:p,startPosition:h})}return E(()=>o.fileStr,i=>{const h=(i?i.split(","):[]).map(p=>({url:p,status:"done",message:"上传成功"}));n.value=h},{immediate:!0}),(i,h)=>{const p=J,c=Ua;return ce(),ue("div",null,[d(c,{modelValue:n.value,"onUpdate:modelValue":h[0]||(h[0]=y=>n.value=y),multiple:o.limit!==1,"max-count":o.limit,accept:t.value.join(","),"before-read":b,"after-read":s,deletable:!1,class:Xt(i.isPreview?"preview-class":""),style:Ft(l.value)},{"preview-cover":Xe(({url:y,status:k})=>[k!=="done"?(ce(),ue(Ae,{key:0},[],64)):(ce(),ue(Ae,{key:1},[S(y)==="image"?(ce(),ue("img",{key:0,src:y,class:"upload-image",onClick:Fe(T=>g(y),["stop"])},null,8,Ma)):Ve("",!0),S(y)==="video"?(ce(),ue("video",Ya,[le("source",{src:y,type:"video/mp4"},null,8,ja),le("source",{src:y,type:"video/ogg"},null,8,Xa),Yt(" 您的浏览器不支持Video标签。 ")])):Ve("",!0)],64)),le("div",{class:"delete-box",onClick:Fe(T=>u(y),["stop"])},[d(p,{name:"../../src/assets/images/common/remove-file.png",size:"4.5vw"})],8,Fa)]),default:Xe(()=>[le("div",Va,[jt(i.$slots,"empty",{},()=>[le("div",Na,[d(p,{name:"../../src/assets/images/common/add-file.png",size:"4vw"}),le("div",Za,Vt(i.emptyTitle),1)])],!0)])]),_:3},8,["modelValue","multiple","max-count","accept","after-read","class","style"])])}}});const Wa=Nt(Ha,[["__scopeId","data-v-0ba1b6c1"]]),Ka={class:"page-wrapper",style:{padding:"20px",background:"rgb(97, 18, 109)"}},Ja=Z({__name:"component",setup(e){const a=ne({fileStr:""});return(o,t)=>(ce(),ue("div",Ka,[d(Wa,{"file-str":a.fileStr,"onUpdate:fileStr":t[0]||(t[0]=l=>a.fileStr=l)},null,8,["file-str"])]))}});export{Ja as default};

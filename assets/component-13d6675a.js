import{g as K,j as Ue,n as F,t as R,k as fe,l as I,T as ze,q as St,s as Le,v as Oe,x as U,y as pt,p as ve,f as ee,d as Z,z as Te,a as u,A as qe,C as At,D as Ae,E as pe,F as Pe,i as ae,m as $,G as E,H as me,J as ge,K as et,L as Ct,P as kt,M as It,N as De,O as xt,Q as Be,R as q,S as tt,I as Q,U as ie,V as zt,W as at,X as ot,Y as Pt,Z as Ot,$ as J,a0 as Ce,a1 as je,a2 as G,a3 as Tt,a4 as Rt,a5 as de,a6 as Vt,a7 as _t,a8 as Ee,a9 as Dt,aa as Ve,ab as Ut,ac as Se,ad as Lt,ae as nt,af as Bt,ag as lt,ah as it,ai as Et,aj as st,ak as Mt,al as Yt,o as ne,c as le,w as Fe,am as $e,e as se,b as jt,an as Xe,ao as We,ap as Ft,_ as $t}from"./index-332b4199.js";import{L as Me}from"./index-e1f2aee1.js";function he(e){const a=Ue();a&&K(a.proxy,e)}const Xt={show:Boolean,zIndex:F,overlay:R,duration:F,teleport:[String,Object],lockScroll:R,lazyRender:R,beforeClose:Function,overlayStyle:Object,overlayClass:fe,transitionAppear:Boolean,closeOnClickOverlay:R};function Wt(e,a){return e>a?"horizontal":a>e?"vertical":""}function Ye(){const e=I(0),a=I(0),l=I(0),t=I(0),o=I(0),n=I(0),f=I(""),m=I(!0),S=()=>f.value==="vertical",y=()=>f.value==="horizontal",r=()=>{l.value=0,t.value=0,o.value=0,n.value=0,f.value="",m.value=!0};return{move:v=>{const h=v.touches[0];l.value=(h.clientX<0?0:h.clientX)-e.value,t.value=h.clientY-a.value,o.value=Math.abs(l.value),n.value=Math.abs(t.value);const A=10;(!f.value||o.value<A&&n.value<A)&&(f.value=Wt(o.value,n.value)),m.value&&(o.value>ze||n.value>ze)&&(m.value=!1)},start:v=>{r(),e.value=v.touches[0].clientX,a.value=v.touches[0].clientY},reset:r,startX:e,startY:a,deltaX:l,deltaY:t,offsetX:o,offsetY:n,direction:f,isVertical:S,isHorizontal:y,isTap:m}}let ye=0;const Ze="van-overflow-hidden";function Zt(e,a){const l=Ye(),t="01",o="10",n=r=>{l.move(r);const d=l.deltaY.value>0?o:t,s=pt(r.target,e.value),{scrollHeight:v,offsetHeight:h,scrollTop:A}=s;let i="11";A===0?i=h>=v?"00":"01":A+h>=v&&(i="10"),i!=="11"&&l.isVertical()&&!(parseInt(i,2)&parseInt(d,2))&&ve(r,!0)},f=()=>{document.addEventListener("touchstart",l.start),document.addEventListener("touchmove",n,{passive:!1}),ye||document.body.classList.add(Ze),ye++},m=()=>{ye&&(document.removeEventListener("touchstart",l.start),document.removeEventListener("touchmove",n),ye--,ye||document.body.classList.remove(Ze))},S=()=>a()&&f(),y=()=>a()&&m();St(S),Le(y),Oe(y),U(a,r=>{r?f():m()})}function rt(e){const a=I(!1);return U(e,l=>{l&&(a.value=l)},{immediate:!0}),l=>()=>a.value?l():null}const[Nt,Ht]=ee("overlay"),Gt={show:Boolean,zIndex:F,duration:F,className:fe,lockScroll:R,lazyRender:R,customStyle:Object};var Kt=Z({name:Nt,props:Gt,setup(e,{slots:a}){const l=I(),t=rt(()=>e.show||!e.lazyRender),o=f=>{e.lockScroll&&ve(f,!0)},n=t(()=>{var f;const m=K(At(e.zIndex),e.customStyle);return Ae(e.duration)&&(m.animationDuration=`${e.duration}s`),pe(u("div",{ref:l,style:m,class:[Ht(),e.className]},[(f=a.default)==null?void 0:f.call(a)]),[[Pe,e.show]])});return Te("touchmove",o,{target:l}),()=>u(qe,{name:"van-fade",appear:!0},{default:n})}});const Jt=ae(Kt),Qt=K({},Xt,{round:Boolean,position:$("center"),closeIcon:$("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:$("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[qt,Ne]=ee("popup");var ea=Z({name:qt,inheritAttrs:!1,props:Qt,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:a,attrs:l,slots:t}){let o,n;const f=I(),m=I(),S=rt(()=>e.show||!e.lazyRender),y=E(()=>{const c={zIndex:f.value};if(Ae(e.duration)){const b=e.position==="center"?"animationDuration":"transitionDuration";c[b]=`${e.duration}s`}return c}),r=()=>{o||(o=!0,f.value=e.zIndex!==void 0?+e.zIndex:xt(),a("open"))},d=()=>{o&&Be(e.beforeClose,{done(){o=!1,a("close"),a("update:show",!1)}})},s=c=>{a("clickOverlay",c),e.closeOnClickOverlay&&d()},v=()=>{if(e.overlay)return u(Jt,{show:e.show,class:e.overlayClass,zIndex:f.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:s},{default:t["overlay-content"]})},h=c=>{a("clickCloseIcon",c),d()},A=()=>{if(e.closeable)return u(Q,{role:"button",tabindex:0,name:e.closeIcon,class:[Ne("close-icon",e.closeIconPosition),tt],classPrefix:e.iconPrefix,onClick:h},null)};let i;const x=()=>{i&&clearTimeout(i),i=setTimeout(()=>{a("opened")})},p=()=>a("closed"),z=c=>a("keydown",c),V=S(()=>{var c;const{round:b,position:P,safeAreaInsetTop:O,safeAreaInsetBottom:B}=e;return pe(u("div",q({ref:m,style:y.value,role:"dialog",tabindex:0,class:[Ne({round:b,[P]:P}),{"van-safe-area-top":O,"van-safe-area-bottom":B}],onKeydown:z},l),[(c=t.default)==null?void 0:c.call(t),A()]),[[Pe,e.show]])}),L=()=>{const{position:c,transition:b,transitionAppear:P}=e,O=c==="center"?"van-fade":`van-popup-slide-${c}`;return u(qe,{name:b||O,appear:P,onAfterEnter:x,onAfterLeave:p},{default:V})};return U(()=>e.show,c=>{c&&!o&&(r(),l.tabindex===0&&me(()=>{var b;(b=m.value)==null||b.focus()})),!c&&o&&(o=!1,a("close"))}),he({popupRef:m}),Zt(m,()=>e.show&&e.lockScroll),Te("popstate",()=>{e.closeOnPopstate&&(d(),n=!1)}),ge(()=>{e.show&&r()}),et(()=>{n&&(a("update:show",!0),n=!1)}),Le(()=>{e.show&&e.teleport&&(d(),n=!0)}),Ct(kt,()=>e.show),()=>e.teleport?u(It,{to:e.teleport},{default:()=>[v(),L()]}):u(De,null,[v(),L()])}});const ct=ae(ea),[ut,ke]=ee("swipe"),ta={loop:R,width:F,height:F,vertical:Boolean,autoplay:J(0),duration:J(500),touchable:R,lazyRender:Boolean,initialSwipe:J(0),indicatorColor:String,showIndicators:R,stopPropagation:R},dt=Symbol(ut);var aa=Z({name:ut,props:ta,emits:["change","dragStart","dragEnd"],setup(e,{emit:a,slots:l}){const t=I(),o=I(),n=ie({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let f=!1;const m=Ye(),{children:S,linkChildren:y}=zt(dt),r=E(()=>S.length),d=E(()=>n[e.vertical?"height":"width"]),s=E(()=>e.vertical?m.deltaY.value:m.deltaX.value),v=E(()=>n.rect?(e.vertical?n.rect.height:n.rect.width)-d.value*r.value:0),h=E(()=>d.value?Math.ceil(Math.abs(v.value)/d.value):r.value),A=E(()=>r.value*d.value),i=E(()=>(n.active+r.value)%r.value),x=E(()=>{const w=e.vertical?"vertical":"horizontal";return m.direction.value===w}),p=E(()=>{const w={transitionDuration:`${n.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${n.offset}px)`};if(d.value){const T=e.vertical?"height":"width",_=e.vertical?"width":"height";w[T]=`${A.value}px`,w[_]=e[_]?`${e[_]}px`:""}return w}),z=w=>{const{active:T}=n;return w?e.loop?G(T+w,-1,r.value):G(T+w,0,h.value):T},V=(w,T=0)=>{let _=w*d.value;e.loop||(_=Math.min(_,-v.value));let W=T-_;return e.loop||(W=G(W,v.value,0)),W},L=({pace:w=0,offset:T=0,emitChange:_})=>{if(r.value<=1)return;const{active:W}=n,X=z(w),we=V(X,T);if(e.loop){if(S[0]&&we!==v.value){const Re=we<v.value;S[0].setOffset(Re?A.value:0)}if(S[r.value-1]&&we!==0){const Re=we>0;S[r.value-1].setOffset(Re?-A.value:0)}}n.active=X,n.offset=we,_&&X!==W&&a("change",i.value)},c=()=>{n.swiping=!0,n.active<=-1?L({pace:r.value}):n.active>=r.value&&L({pace:-r.value})},b=()=>{c(),m.reset(),Ce(()=>{n.swiping=!1,L({pace:-1,emitChange:!0})})},P=()=>{c(),m.reset(),Ce(()=>{n.swiping=!1,L({pace:1,emitChange:!0})})};let O;const B=()=>clearTimeout(O),Y=()=>{B(),+e.autoplay>0&&r.value>1&&(O=setTimeout(()=>{P(),Y()},+e.autoplay))},N=(w=+e.initialSwipe)=>{if(!t.value)return;const T=()=>{var _,W;if(!je(t)){const X={width:t.value.offsetWidth,height:t.value.offsetHeight};n.rect=X,n.width=+((_=e.width)!=null?_:X.width),n.height=+((W=e.height)!=null?W:X.height)}r.value&&(w=Math.min(r.value-1,w),w===-1&&(w=r.value-1)),n.active=w,n.swiping=!0,n.offset=V(w),S.forEach(X=>{X.setOffset(0)}),Y()};je(t)?me().then(T):T()},te=()=>N(n.active);let oe;const g=w=>{!e.touchable||w.touches.length>1||(m.start(w),f=!1,oe=Date.now(),B(),c())},C=w=>{e.touchable&&n.swiping&&(m.move(w),x.value&&(!e.loop&&(n.active===0&&s.value>0||n.active===r.value-1&&s.value<0)||(ve(w,e.stopPropagation),L({offset:s.value}),f||(a("dragStart",{index:i.value}),f=!0))))},k=()=>{if(!e.touchable||!n.swiping)return;const w=Date.now()-oe,T=s.value/w;if((Math.abs(T)>.25||Math.abs(s.value)>d.value/2)&&x.value){const W=e.vertical?m.offsetY.value:m.offsetX.value;let X=0;e.loop?X=W>0?s.value>0?-1:1:0:X=-Math[s.value>0?"ceil":"floor"](s.value/d.value),L({pace:X,emitChange:!0})}else s.value&&L({pace:0});f=!1,n.swiping=!1,a("dragEnd",{index:i.value}),Y()},M=(w,T={})=>{c(),m.reset(),Ce(()=>{let _;e.loop&&w===r.value?_=n.active===0?0:w:_=w%r.value,T.immediate?Ce(()=>{n.swiping=!1}):n.swiping=!1,L({pace:_-n.active,emitChange:!0})})},j=(w,T)=>{const _=T===i.value,W=_?{backgroundColor:e.indicatorColor}:void 0;return u("i",{style:W,class:ke("indicator",{active:_})},null)},H=()=>{if(l.indicator)return l.indicator({active:i.value,total:r.value});if(e.showIndicators&&r.value>1)return u("div",{class:ke("indicators",{vertical:e.vertical})},[Array(r.value).fill("").map(j)])};return he({prev:b,next:P,state:n,resize:te,swipeTo:M}),y({size:d,props:e,count:r,activeIndicator:i}),U(()=>e.initialSwipe,w=>N(+w)),U(r,()=>N(n.active)),U(()=>e.autoplay,Y),U([at,ot,()=>e.width,()=>e.height],te),U(Pt(),w=>{w==="visible"?Y():B()}),ge(N),et(()=>N(n.active)),Ot(()=>N(n.active)),Le(B),Oe(B),Te("touchmove",C,{target:o}),()=>{var w;return u("div",{ref:t,class:ke()},[u("div",{ref:o,style:p.value,class:ke("track",{vertical:e.vertical}),onTouchstartPassive:g,onTouchend:k,onTouchcancel:k},[(w=l.default)==null?void 0:w.call(l)]),H()])}}});const oa=ae(aa),[na,la]=ee("swipe-item");var ia=Z({name:na,setup(e,{slots:a}){let l;const t=ie({offset:0,inited:!1,mounted:!1}),{parent:o,index:n}=Tt(dt);if(!o)return;const f=E(()=>{const y={},{vertical:r}=o.props;return o.size.value&&(y[r?"height":"width"]=`${o.size.value}px`),t.offset&&(y.transform=`translate${r?"Y":"X"}(${t.offset}px)`),y}),m=E(()=>{const{loop:y,lazyRender:r}=o.props;if(!r||l)return!0;if(!t.mounted)return!1;const d=o.activeIndicator.value,s=o.count.value-1,v=d===0&&y?s:d-1,h=d===s&&y?0:d+1;return l=n.value===d||n.value===v||n.value===h,l}),S=y=>{t.offset=y};return ge(()=>{me(()=>{t.mounted=!0})}),he({setOffset:S}),()=>{var y;return u("div",{class:la(),style:f.value},[m.value?(y=a.default)==null?void 0:y.call(a):null])}}});const sa=ae(ia);let be=0;function ra(e){e?(be||document.body.classList.add("van-toast--unclickable"),be++):be&&(be--,be||document.body.classList.remove("van-toast--unclickable"))}const[ca,re]=ee("toast"),ua=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],da={icon:String,show:Boolean,type:$("text"),overlay:Boolean,message:F,iconSize:F,duration:Vt(2e3),position:$("middle"),teleport:[String,Object],wordBreak:String,className:fe,iconPrefix:String,transition:$("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:fe,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var vt=Z({name:ca,props:da,emits:["update:show"],setup(e,{emit:a,slots:l}){let t,o=!1;const n=()=>{const d=e.show&&e.forbidClick;o!==d&&(o=d,ra(o))},f=d=>a("update:show",d),m=()=>{e.closeOnClick&&f(!1)},S=()=>clearTimeout(t),y=()=>{const{icon:d,type:s,iconSize:v,iconPrefix:h,loadingType:A}=e;if(d||s==="success"||s==="fail")return u(Q,{name:d||s,size:v,class:re("icon"),classPrefix:h},null);if(s==="loading")return u(Me,{class:re("loading"),size:v,type:A},null)},r=()=>{const{type:d,message:s}=e;if(l.message)return u("div",{class:re("text")},[l.message()]);if(Ae(s)&&s!=="")return d==="html"?u("div",{key:0,class:re("text"),innerHTML:String(s)},null):u("div",{class:re("text")},[s])};return U(()=>[e.show,e.forbidClick],n),U(()=>[e.show,e.type,e.message,e.duration],()=>{S(),e.show&&e.duration>0&&(t=setTimeout(()=>{f(!1)},e.duration))}),ge(n),Rt(n),()=>u(ct,q({class:[re([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:m,onClosed:S,"onUpdate:show":f},de(e,ua)),{default:()=>[y(),r()]})}});function ft(){const e=ie({show:!1}),a=o=>{e.show=o},l=o=>{K(e,o,{transitionAppear:!0}),a(!0)},t=()=>a(!1);return he({open:l,close:t,toggle:a}),{open:l,close:t,state:e,toggle:a}}function mt(e){const a=_t(e),l=document.createElement("div");return document.body.appendChild(l),{instance:a.mount(l),unmount(){a.unmount(),document.body.removeChild(l)}}}const va={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let Ie=[],fa=!1,He=K({},va);const ma=new Map;function ga(e){return Dt(e)?e:{message:e}}function ha(){const{instance:e,unmount:a}=mt({setup(){const l=I(""),{open:t,state:o,close:n,toggle:f}=ft(),m=()=>{},S=()=>u(vt,q(o,{onClosed:m,"onUpdate:show":f}),null);return U(l,y=>{o.message=y}),Ue().render=S,{open:t,close:n,message:l}}});return e}function wa(){if(!Ie.length||fa){const e=ha();Ie.push(e)}return Ie[Ie.length-1]}function Ge(e={}){if(!Ee)return{};const a=wa(),l=ga(e);return a.open(K({},He,ma.get(l.type||He.type),l)),a}ae(vt);const[ya,ce]=ee("image"),ba={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:F,height:F,radius:F,lazyLoad:Boolean,iconSize:F,showError:R,errorIcon:$("photo-fail"),iconPrefix:String,showLoading:R,loadingIcon:$("photo")};var Sa=Z({name:ya,props:ba,emits:["load","error"],setup(e,{emit:a,slots:l}){const t=I(!1),o=I(!0),n=I(),{$Lazyload:f}=Ue().proxy,m=E(()=>{const i={width:Ve(e.width),height:Ve(e.height)};return Ae(e.radius)&&(i.overflow="hidden",i.borderRadius=Ve(e.radius)),i});U(()=>e.src,()=>{t.value=!1,o.value=!0});const S=i=>{o.value&&(o.value=!1,a("load",i))},y=()=>{const i=new Event("load");Object.defineProperty(i,"target",{value:n.value,enumerable:!0}),S(i)},r=i=>{t.value=!0,o.value=!1,a("error",i)},d=(i,x,p)=>p?p():u(Q,{name:i,size:e.iconSize,class:x,classPrefix:e.iconPrefix},null),s=()=>{if(o.value&&e.showLoading)return u("div",{class:ce("loading")},[d(e.loadingIcon,ce("loading-icon"),l.loading)]);if(t.value&&e.showError)return u("div",{class:ce("error")},[d(e.errorIcon,ce("error-icon"),l.error)])},v=()=>{if(t.value||!e.src)return;const i={alt:e.alt,class:ce("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?pe(u("img",q({ref:n},i),null),[[Ut("lazy"),e.src]]):u("img",q({ref:n,src:e.src,onLoad:S,onError:r},i),null)},h=({el:i})=>{const x=()=>{i===n.value&&o.value&&y()};n.value?x():me(x)},A=({el:i})=>{i===n.value&&!t.value&&r()};return f&&Ee&&(f.$on("loaded",h),f.$on("error",A),Oe(()=>{f.$off("loaded",h),f.$off("error",A)})),ge(()=>{me(()=>{var i;(i=n.value)!=null&&i.complete&&!e.lazyLoad&&y()})}),()=>{var i;return u("div",{class:ce({round:e.round,block:e.block}),style:m.value},[v(),s(),(i=l.default)==null?void 0:i.call(l)])}}});const gt=ae(Sa),Ke=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),pa=e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}),_e=ee("image-preview")[1],Je=2.6;var Aa=Z({props:{src:String,show:Boolean,active:Number,minZoom:Se(F),maxZoom:Se(F),rootWidth:Se(Number),rootHeight:Se(Number),disableZoom:Boolean,closeOnClickOverlay:Boolean},emits:["scale","close","longPress"],setup(e,{emit:a,slots:l}){const t=ie({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),o=Ye(),n=I(),f=I(),m=I(!1),S=I(!1);let y=0;const r=E(()=>{const{scale:g,moveX:C,moveY:k,moving:M,zooming:j,initializing:H}=t,w={transitionDuration:j||M||H?"0s":".3s"};return(g!==1||S.value)&&(w.transform=`matrix(${g}, 0, 0, ${g}, ${C}, ${k})`),w}),d=E(()=>{if(t.imageRatio){const{rootWidth:g,rootHeight:C}=e,k=m.value?C/t.imageRatio:g;return Math.max(0,(t.scale*k-g)/2)}return 0}),s=E(()=>{if(t.imageRatio){const{rootWidth:g,rootHeight:C}=e,k=m.value?C:g*t.imageRatio;return Math.max(0,(t.scale*k-C)/2)}return 0}),v=(g,C)=>{var k;if(g=G(g,+e.minZoom,+e.maxZoom+1),g!==t.scale){const M=g/t.scale;if(t.scale=g,C){const j=nt((k=n.value)==null?void 0:k.$el),H={x:j.width*.5,y:j.height*.5},w=t.moveX-(C.x-j.left-H.x)*(M-1),T=t.moveY-(C.y-j.top-H.y)*(M-1);t.moveX=G(w,-d.value,d.value),t.moveY=G(T,-s.value,s.value)}else t.moveX=0,t.moveY=S.value?y:0;a("scale",{scale:g,index:e.active})}},h=()=>{v(1)},A=()=>{const g=t.scale>1?1:2;v(g,g===2||S.value?{x:o.startX.value,y:o.startY.value}:void 0)};let i,x,p,z,V,L,c,b,P=!1;const O=g=>{const{touches:C}=g;if(i=C.length,i===2&&e.disableZoom)return;const{offsetX:k}=o;o.start(g),x=t.moveX,p=t.moveY,b=Date.now(),P=!1,t.moving=i===1&&(t.scale!==1||S.value),t.zooming=i===2&&!k.value,t.zooming&&(z=t.scale,V=Ke(C))},B=g=>{const{touches:C}=g;if(o.move(g),t.moving){const{deltaX:k,deltaY:M}=o,j=k.value+x,H=M.value+p;if((j>d.value||j<-d.value)&&!P&&o.isHorizontal()){t.moving=!1;return}P=!0,ve(g,!0),t.moveX=G(j,-d.value,d.value),t.moveY=G(H,-s.value,s.value)}if(t.zooming&&(ve(g,!0),C.length===2)){const k=Ke(C),M=z*k/V;L=pa(C),v(M,L)}},Y=g=>{var C;if(i>1)return;const{offsetX:k,offsetY:M}=o,j=Date.now()-b,H=250;if(k.value<ze&&M.value<ze)if(j<H)if(c)clearTimeout(c),c=null,A();else{if(!e.closeOnClickOverlay&&g.target===((C=f.value)==null?void 0:C.$el))return;c=setTimeout(()=>{a("close"),c=null},H)}else j>Bt&&a("longPress")},N=g=>{let C=!1;if((t.moving||t.zooming)&&(C=!0,t.moving&&x===t.moveX&&p===t.moveY&&(C=!1),!g.touches.length)){t.zooming&&(t.moveX=G(t.moveX,-d.value,d.value),t.moveY=G(t.moveY,-s.value,s.value),t.zooming=!1),t.moving=!1,x=0,p=0,z=1,t.scale<1&&h();const k=+e.maxZoom;t.scale>k&&v(k,L)}ve(g,C),Y(g),o.reset()},te=()=>{const{rootWidth:g,rootHeight:C}=e,k=C/g,{imageRatio:M}=t;m.value=t.imageRatio>k&&M<Je,S.value=t.imageRatio>k&&M>=Je,S.value&&(y=(M*g-C)/2,t.moveY=y,t.initializing=!0,Lt(()=>{t.initializing=!1})),h()},oe=g=>{const{naturalWidth:C,naturalHeight:k}=g.target;t.imageRatio=k/C,te()};return U(()=>e.active,h),U(()=>e.show,g=>{g||h()}),U(()=>[e.rootWidth,e.rootHeight],te),Te("touchmove",B,{target:E(()=>{var g;return(g=f.value)==null?void 0:g.$el})}),()=>{const g={loading:()=>u(Me,{type:"spinner"},null)};return u(sa,{ref:f,class:_e("swipe-item"),onTouchstartPassive:O,onTouchend:N,onTouchcancel:N},{default:()=>[l.image?u("div",{class:_e("image-wrap")},[l.image({src:e.src})]):u(gt,{ref:n,src:e.src,fit:"contain",class:_e("image",{vertical:m.value}),style:r.value,onLoad:oe},g)]})}}});const[Ca,ue]=ee("image-preview"),ka=["show","teleport","transition","overlayStyle","closeOnPopstate"],Ia={show:Boolean,loop:R,images:lt(),minZoom:J(1/3),maxZoom:J(3),overlay:R,closeable:Boolean,showIndex:R,className:fe,closeIcon:$("clear"),transition:String,beforeClose:Function,overlayClass:fe,overlayStyle:Object,swipeDuration:J(300),startPosition:J(0),showIndicators:Boolean,closeOnPopstate:R,closeOnClickOverlay:R,closeIconPosition:$("top-right"),teleport:[String,Object]};var ht=Z({name:Ca,props:Ia,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:a,slots:l}){const t=I(),o=ie({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),n=()=>{if(t.value){const p=nt(t.value.$el);o.rootWidth=p.width,o.rootHeight=p.height,t.value.resize()}},f=p=>a("scale",p),m=p=>a("update:show",p),S=()=>{Be(e.beforeClose,{args:[o.active],done:()=>m(!1)})},y=p=>{p!==o.active&&(o.active=p,a("change",p))},r=()=>{if(e.showIndex)return u("div",{class:ue("index")},[l.index?l.index({index:o.active}):`${o.active+1} / ${e.images.length}`])},d=()=>{if(l.cover)return u("div",{class:ue("cover")},[l.cover()])},s=()=>{o.disableZoom=!0},v=()=>{o.disableZoom=!1},h=()=>u(oa,{ref:t,lazyRender:!0,loop:e.loop,class:ue("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:y,onDragEnd:v,onDragStart:s},{default:()=>[e.images.map((p,z)=>u(Aa,{src:p,show:e.show,active:o.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:o.rootWidth,rootHeight:o.rootHeight,disableZoom:o.disableZoom,closeOnClickOverlay:e.closeOnClickOverlay,onScale:f,onClose:S,onLongPress:()=>a("longPress",{index:z})},{image:l.image}))]}),A=()=>{if(e.closeable)return u(Q,{role:"button",name:e.closeIcon,class:[ue("close-icon",e.closeIconPosition),tt],onClick:S},null)},i=()=>a("closed"),x=(p,z)=>{var V;return(V=t.value)==null?void 0:V.swipeTo(p,z)};return he({swipeTo:x}),ge(n),U([at,ot],n),U(()=>e.startPosition,p=>y(+p)),U(()=>e.show,p=>{const{images:z,startPosition:V}=e;p?(y(+V),me(()=>{n(),x(+V,{immediate:!0})})):a("close",{index:o.active,url:z[o.active]})}),()=>u(ct,q({class:[ue(),e.className],overlayClass:[ue("overlay"),e.overlayClass],onClosed:i,"onUpdate:show":m},de(e,ka)),{default:()=>[A(),h(),r(),d()]})}});let xe;const xa={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function za(){({instance:xe}=mt({setup(){const{state:e,toggle:a}=ft(),l=()=>{e.images=[]};return()=>u(ht,q(e,{onClosed:l,"onUpdate:show":a}),null)}}))}const wt=(e,a=0)=>{if(Ee)return xe||za(),e=Array.isArray(e)?{images:e,startPosition:a}:e,xe.open(K({},xa,e)),xe};ae(ht);const[Pa,D,Oa]=ee("uploader");function Qe(e,a){return new Promise(l=>{if(a==="file"){l();return}const t=new FileReader;t.onload=o=>{l(o.target.result)},a==="dataUrl"?t.readAsDataURL(e):a==="text"&&t.readAsText(e)})}function yt(e,a){return it(e).some(l=>l.file?Et(a)?a(l.file):l.file.size>+a:!1)}function Ta(e,a){const l=[],t=[];return e.forEach(o=>{yt(o,a)?t.push(o):l.push(o)}),{valid:l,invalid:t}}const Ra=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,Va=e=>Ra.test(e);function bt(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?Va(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var _a=Z({props:{name:F,item:Se(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:a,slots:l}){const t=()=>{const{status:r,message:d}=e.item;if(r==="uploading"||r==="failed"){const s=r==="failed"?u(Q,{name:"close",class:D("mask-icon")},null):u(Me,{class:D("loading")},null),v=Ae(d)&&d!=="";return u("div",{class:D("mask")},[s,v&&u("div",{class:D("mask-message")},[d])])}},o=r=>{const{name:d,item:s,index:v,beforeDelete:h}=e;r.stopPropagation(),Be(h,{args:[s,{name:d,index:v}],done:()=>a("delete")})},n=()=>a("preview"),f=()=>a("reupload"),m=()=>{if(e.deletable&&e.item.status!=="uploading"){const r=l["preview-delete"];return u("div",{role:"button",class:D("preview-delete",{shadow:!r}),tabindex:0,"aria-label":Oa("delete"),onClick:o},[r?r():u(Q,{name:"cross",class:D("preview-delete-icon")},null)])}},S=()=>{if(l["preview-cover"]){const{index:r,item:d}=e;return u("div",{class:D("preview-cover")},[l["preview-cover"](K({index:r},d))])}},y=()=>{const{item:r,lazyLoad:d,imageFit:s,previewSize:v,reupload:h}=e;return bt(r)?u(gt,{fit:s,src:r.objectUrl||r.content||r.url,class:D("preview-image"),width:Array.isArray(v)?v[0]:v,height:Array.isArray(v)?v[1]:v,lazyLoad:d,onClick:h?f:n},{default:S}):u("div",{class:D("file"),style:st(e.previewSize)},[u(Q,{class:D("file-icon"),name:"description"},null),u("div",{class:[D("file-name"),"van-ellipsis"]},[r.file?r.file.name:r.url]),S()])};return()=>u("div",{class:D("preview")},[y(),t(),m()])}});const Da={name:J(""),accept:$("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:J(1/0),imageFit:$("cover"),resultType:$("dataUrl"),uploadIcon:$("photograph"),uploadText:String,deletable:R,reupload:Boolean,afterRead:Function,showUpload:R,modelValue:lt(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:R,previewOptions:Object,previewFullImage:R,maxSize:{type:[Number,String,Function],default:1/0}};var Ua=Z({name:Pa,props:Da,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:a,slots:l}){const t=I(),o=[],n=I(-1),f=(c=e.modelValue.length)=>({name:e.name,index:c}),m=()=>{t.value&&(t.value.value="")},S=c=>{if(m(),yt(c,e.maxSize))if(Array.isArray(c)){const b=Ta(c,e.maxSize);if(c=b.valid,a("oversize",b.invalid,f()),!c.length)return}else{a("oversize",c,f());return}if(c=ie(c),n.value>-1){const b=[...e.modelValue];b.splice(n.value,1,c),a("update:modelValue",b),n.value=-1}else a("update:modelValue",[...e.modelValue,...it(c)]);e.afterRead&&e.afterRead(c,f())},y=c=>{const{maxCount:b,modelValue:P,resultType:O}=e;if(Array.isArray(c)){const B=+b-P.length;c.length>B&&(c=c.slice(0,B)),Promise.all(c.map(Y=>Qe(Y,O))).then(Y=>{const N=c.map((te,oe)=>{const g={file:te,status:"",message:"",objectUrl:URL.createObjectURL(te)};return Y[oe]&&(g.content=Y[oe]),g});S(N)})}else Qe(c,O).then(B=>{const Y={file:c,status:"",message:"",objectUrl:URL.createObjectURL(c)};B&&(Y.content=B),S(Y)})},r=c=>{const{files:b}=c.target;if(e.disabled||!b||!b.length)return;const P=b.length===1?b[0]:[].slice.call(b);if(e.beforeRead){const O=e.beforeRead(P,f());if(!O){m();return}if(Yt(O)){O.then(B=>{y(B||P)}).catch(m);return}}y(P)};let d;const s=()=>a("closePreview"),v=c=>{if(e.previewFullImage){const b=e.modelValue.filter(bt),P=b.map(O=>(O.objectUrl&&!O.url&&O.status!=="failed"&&(O.url=O.objectUrl,o.push(O.url)),O.url)).filter(Boolean);d=wt(K({images:P,startPosition:b.indexOf(c),onClose:s},e.previewOptions))}},h=()=>{d&&d.close()},A=(c,b)=>{const P=e.modelValue.slice(0);P.splice(b,1),a("update:modelValue",P),a("delete",c,f(b))},i=c=>{L(),n.value=c},x=(c,b)=>{const P=["imageFit","deletable","reupload","previewSize","beforeDelete"],O=K(de(e,P),de(c,P,!0));return u(_a,q({item:c,index:b,onClick:()=>a(e.reupload?"clickReupload":"clickPreview",c,f(b)),onDelete:()=>A(c,b),onPreview:()=>v(c),onReupload:()=>i(b)},de(e,["name","lazyLoad"]),O),de(l,["preview-cover","preview-delete"]))},p=()=>{if(e.previewImage)return e.modelValue.map(x)},z=c=>a("clickUpload",c),V=()=>{if(e.modelValue.length>=+e.maxCount&&!e.reupload)return;const c=e.modelValue.length>=+e.maxCount&&e.reupload,b=e.readonly?null:u("input",{ref:t,type:"file",class:D("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&n.value===-1,disabled:e.disabled,onChange:r},null);return l.default?pe(u("div",{class:D("input-wrapper"),onClick:z},[l.default(),b]),[[Pe,!c]]):pe(u("div",{class:D("upload",{readonly:e.readonly}),style:st(e.previewSize),onClick:z},[u(Q,{name:e.uploadIcon,class:D("upload-icon")},null),e.uploadText&&u("span",{class:D("upload-text")},[e.uploadText]),b]),[[Pe,e.showUpload&&!c]])},L=()=>{t.value&&!e.disabled&&t.value.click()};return Oe(()=>{o.forEach(c=>URL.revokeObjectURL(c))}),he({chooseFile:L,closeImagePreview:h}),Mt(()=>e.modelValue),()=>u("div",{class:D()},[u("div",{class:D("wrapper",{disabled:e.disabled})},[p(),V()])])}});const La=ae(Ua);const Ba="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAASFJREFUWEftl7FKxEAQhv+xSGWheGAeQQvhrHwDa6tUluKQMpWFjb7FDpeAIJY+gLWlha2NryDXSAwkGTm4yHF4cOtc56Rc9v8Yfr5dNgTDV5blcdd1DwD2+76/zPP80YADWcIi8gTgdM74YOY9C886zCuA8TAAM5t4prCI+DC/quDNrDoh3ow3E3t7ujP/15kQwhWAg1hniOgMwM6QU9W7WAaAaV3Xt0VRTGlZwj/ANhH5SpJkdzaMboJmZajqmEII90R0boUZ8y/MfDJ7z1BVVdtt227FAlX1mYiOFnI//qzLappG0zT9zLKs88fVqta8GW9m3RM17HNn3Bl3xn/8lx0QkQmAi/n6GzMfxnqyuN96z4wAXKvqiIhumPndMsw31ZOxAXvVCIsAAAAASUVORK5CYII=",Ea="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAAAAXNSR0IArs4c6QAABJ1JREFUWEe1mH9MlVUYxz/n3mtIQWOzpJYuylZR1lz+YaEWVozKZC0qHLhklcI/aoWVQatbTWQOVlZbiq7QwFkOV2bFkhGZZbVZzNhYbQaNtcJwYlBE3ntPe8697+3l5d77Xtjl/QvuOe85n/f7/DjPcxSTeLTWc4BCYAmwAMgBsiJLDAK/A13AUeCQUurXZJdXyUzUWt8GbATuAnzJvBOZcwioV0p97vZOQhCt9VXAm8CdslAgqPmiW/NVj+bkb5reATj7V3iLWZkwOwtuyFHkXadYdI0ibUZ0eQFap5TqiwcUF0RrXQZsBzKG/9a0dGr2doYYGXX7tvB4Rjo8sFjx8B0esjLMNv8AlUqp3bFWiAmitX4B8MsLB78OUX8geQDnJqLUxmIPhQs91pBfKfWic94EEAtCzFD7boj3j+nkJHCZVbxYGaCIuSbAjAPRWq8GmsbOaZ7cGeRYT0oYoovk5cKrFT58XvPTKqVUizUYBdFaSyjK1jM37wvS+mVqlHB+yn23KJ4vNSQjkgKUUiflHzvIh8C9bcdDVDeFUiuFYzV/mYeim43PtCulCqIgkTzReWZE81BtkNPD08phIuojv5fM840O+ZJnzF9aa6PGax8EaWqfHpM4P23t3R4q7zGqSAZeoSJpu18ctKAm6Jonrr4M+gdhdCy2apnpMOtC6BtIrKqo0rHFOG5AjgoBqZDEdaQ7xOM7EvtGTjYceM5H74Bm7baJJhSAxvVershWrKwL8JPLSdOwxsOyG40qjwnIOxJKdfuDvHcksVnkK3ZXhTdywtghZGzV1iCj/yZWRXJLzUoTQU0C8gMwv2xrgJ5+dyeVTNm4YTyMxJ6lRDy1Yq284Ep46wlzhnYJyB/ARQXVgaSjxQkjK8VSye2zsi6AjjoDMiQgxh43rROfSf6xw8hbk1HCvst3r4eriqmD2BwzVSBnpMpatikQrS3cdHE65lRNI6oerjWKDIoi30vOf+SVAF0/uyGEc4TTMeUtpwMnk51z50LL0wakW0DeBsqTOejS06D5qTjh64im1Q3uybHkVsUzD5rwbRaQR4Fdn50IUbUzcUKTrLpvU4KEZoO5/+UAfacSK7ytwsPS+SahVVopvjcQxHf7swHXFJ8zGwaHiTsv/TyYezGuWVWOgk83+0ibYWDnjDv0tn8covGT6S0BLI3KCzysL7IdejJglQFSJC/3u9vW3aUTz5Bo2V/ttYrq/8uACMxhaRsOfhPC3zy9qmwp91K40BjDlAAmoVnsWut5kS4t46W9wZQVzU5tipcoakpMpEh7ca1S6pdxIBFVpJdpDgRhww4pnlNbJOXlKhrWeC0HLbf3OHHbibFzUN+auiJaiubqEq9VwSduJ2xmijZYbcc1Da1Tr2MlTKuKPRQtmmSDZYORHkdazplDI5o9HZrWoyGGk2w5BaA030NpvrKKZGkfpOWM9jJ2/3Frwi8H3pDCWl4Sc337ozThIU70ak6dhdN/hpeT2iInWzHvUkwTvvR6j2UGGW6PQJgeJtYz2WsJA5TkIwVOW0quJZwbRir+5baLmkukuovMGwLk2sG6qGmbzEXNf6R4GNnnBuYHAAAAAElFTkSuQmCC",Ma=["src","onClick"],Ya={key:1,controls:"",class:"upload-image"},ja=["src"],Fa=["src"],$a={key:2,class:"upload-image other-box"},Xa=["onClick"],Wa={class:"upload-empty"},Za={class:"empty-box"},Na={class:"empty-text"},Ha=Z({name:"UploadFile",__name:"index",props:{modelValue:{default:""},isPreview:{type:Boolean,default:!1},emptyTitle:{default:"上传"},limit:{default:9},fileSize:{default:12},accept:{default:"image/*"},height:{default:90},width:{default:90},margin:{default:8},borderRadius:{default:8}},emits:["update:modelValue"],setup(e,{emit:a}){const l=e,t=E(()=>{const s=v=>`${v/375*100}vw`;return{"--width":s(l.width),"--height":s(l.height),"--borderRadius":s(l.borderRadius),"--margin":s(l.margin)}}),o=I([]),n=["png","jpg","jpeg","bmp","gif"],f=["mp4","m2v","mkv","mov","3gp"];function m(s=""){var h;const v=((h=s.split(".").pop())==null?void 0:h.toLocaleLowerCase())||"";return n.includes(v)?"image":f.includes(v)?"video":""}function S(s){const v=Array.isArray(s)?s:[s],h=o.value.length,A=v.slice(0,l.limit-h).map(i=>new Promise((x,p)=>{const{size:z,type:V}=i;z/1024/1024>l.fileSize&&(Ge(`上传图片大小不能超过 ${l.fileSize}M！`),p(new Error(`上传图片大小不能超过 ${l.fileSize}M！`))),["false"].includes(V.toLocaleLowerCase())&&(Ge("上传文件不符合所需的格式！"),p(new Error("上传文件不符合所需的格式！"))),x(i)}));return Promise.all(A)}async function y(s){const h=s.map(A=>({...A})).map((A,i)=>new Promise(async(x,p)=>{try{s[i].status="uploading",s[i].message="上传中...";const z=new FormData;z.append("file",A.file),z.append("module","efficacy"),z.append("category","track"),z.append("async","false");const{data:{absoluteUrl:V}}=await Promise.resolve({data:{absoluteUrl:"https://fastly.jsdelivr.net/npm/@vant/assets/leaf.jpeg"}});s[i].status="done",s[i].message="上传成功",s[i].url=V,x({absoluteUrl:V})}catch(z){console.log(z),s[i].status="failed",s[i].message="上传失败",p(new Error("上传失败"))}}));try{await Promise.all(h)}catch{a("update:modelValue","")}finally{const A=o.value.filter(i=>!!i.url).map(i=>i.url).join(",");a("update:modelValue",A)}}function r(s){const v=o.value.filter(h=>h.url!==s).map(h=>h.url).join(",");a("update:modelValue",v)}function d(s){let v=-1;const h=o.value.map((A,i)=>(A.url===s&&(v=i),A.url));wt({images:h,startPosition:v})}return U(()=>l.modelValue,s=>{const v=(s?s.split(","):[]).map(h=>({url:h,status:"done",message:"上传成功"}));o.value=v},{immediate:!0}),(s,v)=>{const h=Q,A=La;return ne(),le("div",null,[u(A,q({modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=i=>o.value=i)},s.$attrs,{multiple:l.limit!==1,"max-count":l.limit,accept:l.accept,"before-read":S,"after-read":y,deletable:!1,class:s.isPreview?"preview-class":"",style:t.value}),{"preview-cover":Fe(({url:i,status:x})=>[x!=="done"?(ne(),le(De,{key:0},[],64)):(ne(),le(De,{key:1},[m(i)==="image"?(ne(),le("img",{key:0,src:i,class:"upload-image",onClick:$e(p=>d(i),["stop"])},null,8,Ma)):m(i)==="video"?(ne(),le("video",Ya,[se("source",{src:i,type:"video/mp4"},null,8,ja),se("source",{src:i,type:"video/ogg"},null,8,Fa),jt(" 您的浏览器不支持Video标签。 ")])):(ne(),le("div",$a,Xe(i),1))],64)),se("div",{class:"delete-box",onClick:$e(p=>r(i),["stop"])},[u(h,{name:We(Ea),size:"4.5vw"},null,8,["name"])],8,Xa)]),default:Fe(()=>[se("div",Wa,[Ft(s.$slots,"empty",{},()=>[se("div",Za,[u(h,{name:We(Ba),size:"4vw"},null,8,["name"]),se("div",Na,Xe(s.emptyTitle),1)])],!0)])]),_:3},16,["modelValue","multiple","max-count","accept","after-read","class","style"])])}}});const Ga=$t(Ha,[["__scopeId","data-v-4afbf693"]]),Ka={class:"page-wrapper",style:{background:"rgb(97, 18, 109)",padding:"20px",display:"flex",gap:"20px","flex-wrap":"wrap"}},qa=Z({__name:"component",setup(e){const a=ie({fileStr:""});return(l,t)=>{const o=Ga;return ne(),le("div",Ka,[u(o,{modelValue:a.fileStr,"onUpdate:modelValue":t[0]||(t[0]=n=>a.fileStr=n),accept:"image/*"},null,8,["modelValue"]),u(o,{modelValue:a.fileStr,"onUpdate:modelValue":t[1]||(t[1]=n=>a.fileStr=n),accept:"image/*,video/*"},null,8,["modelValue"]),u(o,{modelValue:a.fileStr,"onUpdate:modelValue":t[2]||(t[2]=n=>a.fileStr=n),accept:"video/*"},null,8,["modelValue"]),u(o,{modelValue:a.fileStr,"onUpdate:modelValue":t[3]||(t[3]=n=>a.fileStr=n),accept:".txt"},null,8,["modelValue"])])}}});export{qa as default};

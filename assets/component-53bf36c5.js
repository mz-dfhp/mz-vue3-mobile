import{g as K,j as Le,n as F,t as D,k as fe,l as z,T as xe,q as St,s as Ue,v as Oe,x as V,y as Ct,p as ve,f as Q,d as Z,z as Te,a as d,A as Qe,C as At,D as Ae,E as Ce,F as Pe,i as ae,m as $,G as U,H as me,J as ge,K as et,L as pt,P as kt,M as It,N as Be,O as zt,Q as Ve,R as te,S as tt,I as q,U as J,V as ne,W as xt,X as at,Y as ot,Z as Pt,$ as Ot,a0 as pe,a1 as je,a2 as G,a3 as Tt,a4 as Rt,a5 as de,a6 as _t,a7 as Dt,a8 as Ee,a9 as Bt,aa as _e,ab as Lt,ac as Se,ad as Ut,ae as nt,af as Vt,ag as lt,ah as it,ai as Et,aj as st,ak as Mt,al as Yt,o as ce,c as ue,w as Fe,am as $e,an as Xe,e as le,b as jt,ao as We,ap as Ft,aq as $t,ar as Xt,as as Wt,_ as Zt}from"./index-a4beb257.js";import{L as Me}from"./index-6aba1aac.js";function he(e){const a=Le();a&&K(a.proxy,e)}const Nt={show:Boolean,zIndex:F,overlay:D,duration:F,teleport:[String,Object],lockScroll:D,lazyRender:D,beforeClose:Function,overlayStyle:Object,overlayClass:fe,transitionAppear:Boolean,closeOnClickOverlay:D};function Ht(e,a){return e>a?"horizontal":a>e?"vertical":""}function Ye(){const e=z(0),a=z(0),o=z(0),t=z(0),l=z(0),n=z(0),v=z(""),f=z(!0),S=()=>v.value==="vertical",b=()=>v.value==="horizontal",s=()=>{o.value=0,t.value=0,l.value=0,n.value=0,v.value="",f.value=!0};return{move:i=>{const h=i.touches[0];o.value=(h.clientX<0?0:h.clientX)-e.value,t.value=h.clientY-a.value,l.value=Math.abs(o.value),n.value=Math.abs(t.value);const A=10;(!v.value||l.value<A&&n.value<A)&&(v.value=Ht(l.value,n.value)),f.value&&(l.value>xe||n.value>xe)&&(f.value=!1)},start:i=>{s(),e.value=i.touches[0].clientX,a.value=i.touches[0].clientY},reset:s,startX:e,startY:a,deltaX:o,deltaY:t,offsetX:l,offsetY:n,direction:v,isVertical:S,isHorizontal:b,isTap:f}}let ye=0;const Ze="van-overflow-hidden";function Gt(e,a){const o=Ye(),t="01",l="10",n=s=>{o.move(s);const u=o.deltaY.value>0?l:t,g=Ct(s.target,e.value),{scrollHeight:i,offsetHeight:h,scrollTop:A}=g;let c="11";A===0?c=h>=i?"00":"01":A+h>=i&&(c="10"),c!=="11"&&o.isVertical()&&!(parseInt(c,2)&parseInt(u,2))&&ve(s,!0)},v=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",n,{passive:!1}),ye||document.body.classList.add(Ze),ye++},f=()=>{ye&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",n),ye--,ye||document.body.classList.remove(Ze))},S=()=>a()&&v(),b=()=>a()&&f();St(S),Ue(b),Oe(b),V(a,s=>{s?v():f()})}function rt(e){const a=z(!1);return V(e,o=>{o&&(a.value=o)},{immediate:!0}),o=>()=>a.value?o():null}const[Kt,Jt]=Q("overlay"),qt={show:Boolean,zIndex:F,duration:F,className:fe,lockScroll:D,lazyRender:D,customStyle:Object};var Qt=Z({name:Kt,props:qt,setup(e,{slots:a}){const o=z(),t=rt(()=>e.show||!e.lazyRender),l=v=>{e.lockScroll&&ve(v,!0)},n=t(()=>{var v;const f=K(At(e.zIndex),e.customStyle);return Ae(e.duration)&&(f.animationDuration=`${e.duration}s`),Ce(d("div",{ref:o,style:f,class:[Jt(),e.className]},[(v=a.default)==null?void 0:v.call(a)]),[[Pe,e.show]])});return Te("touchmove",l,{target:o}),()=>d(Qe,{name:"van-fade",appear:!0},{default:n})}});const ea=ae(Qt),ta=K({},Nt,{round:Boolean,position:$("center"),closeIcon:$("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:$("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[aa,Ne]=Q("popup");var oa=Z({name:aa,inheritAttrs:!1,props:ta,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:a,attrs:o,slots:t}){let l,n;const v=z(),f=z(),S=rt(()=>e.show||!e.lazyRender),b=U(()=>{const r={zIndex:v.value};if(Ae(e.duration)){const C=e.position==="center"?"animationDuration":"transitionDuration";r[C]=`${e.duration}s`}return r}),s=()=>{l||(l=!0,v.value=e.zIndex!==void 0?+e.zIndex:zt(),a("open"))},u=()=>{l&&Ve(e.beforeClose,{done(){l=!1,a("close"),a("update:show",!1)}})},g=r=>{a("clickOverlay",r),e.closeOnClickOverlay&&u()},i=()=>{if(e.overlay)return d(ea,{show:e.show,class:e.overlayClass,zIndex:v.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:g},{default:t["overlay-content"]})},h=r=>{a("clickCloseIcon",r),u()},A=()=>{if(e.closeable)return d(q,{role:"button",tabindex:0,name:e.closeIcon,class:[Ne("close-icon",e.closeIconPosition),tt],classPrefix:e.iconPrefix,onClick:h},null)};let c;const w=()=>{c&&clearTimeout(c),c=setTimeout(()=>{a("opened")})},p=()=>a("closed"),T=r=>a("keydown",r),O=S(()=>{var r;const{round:C,position:x,safeAreaInsetTop:P,safeAreaInsetBottom:E}=e;return Ce(d("div",te({ref:f,style:b.value,role:"dialog",tabindex:0,class:[Ne({round:C,[x]:x}),{"van-safe-area-top":P,"van-safe-area-bottom":E}],onKeydown:T},o),[(r=t.default)==null?void 0:r.call(t),A()]),[[Pe,e.show]])}),R=()=>{const{position:r,transition:C,transitionAppear:x}=e,P=r==="center"?"van-fade":`van-popup-slide-${r}`;return d(Qe,{name:C||P,appear:x,onAfterEnter:w,onAfterLeave:p},{default:O})};return V(()=>e.show,r=>{r&&!l&&(s(),o.tabindex===0&&me(()=>{var C;(C=f.value)==null||C.focus()})),!r&&l&&(l=!1,a("close"))}),he({popupRef:f}),Gt(f,()=>e.show&&e.lockScroll),Te("popstate",()=>{e.closeOnPopstate&&(u(),n=!1)}),ge(()=>{e.show&&s()}),et(()=>{n&&(a("update:show",!0),n=!1)}),Ue(()=>{e.show&&e.teleport&&(u(),n=!0)}),pt(kt,()=>e.show),()=>e.teleport?d(It,{to:e.teleport},{default:()=>[i(),R()]}):d(Be,null,[i(),R()])}});const ct=ae(oa),[ut,ke]=Q("swipe"),na={loop:D,width:F,height:F,vertical:Boolean,autoplay:J(0),duration:J(500),touchable:D,lazyRender:Boolean,initialSwipe:J(0),indicatorColor:String,showIndicators:D,stopPropagation:D},dt=Symbol(ut);var la=Z({name:ut,props:na,emits:["change","dragStart","dragEnd"],setup(e,{emit:a,slots:o}){const t=z(),l=z(),n=ne({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let v=!1;const f=Ye(),{children:S,linkChildren:b}=xt(dt),s=U(()=>S.length),u=U(()=>n[e.vertical?"height":"width"]),g=U(()=>e.vertical?f.deltaY.value:f.deltaX.value),i=U(()=>n.rect?(e.vertical?n.rect.height:n.rect.width)-u.value*s.value:0),h=U(()=>u.value?Math.ceil(Math.abs(i.value)/u.value):s.value),A=U(()=>s.value*u.value),c=U(()=>(n.active+s.value)%s.value),w=U(()=>{const y=e.vertical?"vertical":"horizontal";return f.direction.value===y}),p=U(()=>{const y={transitionDuration:`${n.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${n.offset}px)`};if(u.value){const _=e.vertical?"height":"width",B=e.vertical?"width":"height";y[_]=`${A.value}px`,y[B]=e[B]?`${e[B]}px`:""}return y}),T=y=>{const{active:_}=n;return y?e.loop?G(_+y,-1,s.value):G(_+y,0,h.value):_},O=(y,_=0)=>{let B=y*u.value;e.loop||(B=Math.min(B,-i.value));let W=_-B;return e.loop||(W=G(W,i.value,0)),W},R=({pace:y=0,offset:_=0,emitChange:B})=>{if(s.value<=1)return;const{active:W}=n,X=T(y),we=O(X,_);if(e.loop){if(S[0]&&we!==i.value){const Re=we<i.value;S[0].setOffset(Re?A.value:0)}if(S[s.value-1]&&we!==0){const Re=we>0;S[s.value-1].setOffset(Re?-A.value:0)}}n.active=X,n.offset=we,B&&X!==W&&a("change",c.value)},r=()=>{n.swiping=!0,n.active<=-1?R({pace:s.value}):n.active>=s.value&&R({pace:-s.value})},C=()=>{r(),f.reset(),pe(()=>{n.swiping=!1,R({pace:-1,emitChange:!0})})},x=()=>{r(),f.reset(),pe(()=>{n.swiping=!1,R({pace:1,emitChange:!0})})};let P;const E=()=>clearTimeout(P),Y=()=>{E(),+e.autoplay>0&&s.value>1&&(P=setTimeout(()=>{x(),Y()},+e.autoplay))},N=(y=+e.initialSwipe)=>{if(!t.value)return;const _=()=>{var B,W;if(!je(t)){const X={width:t.value.offsetWidth,height:t.value.offsetHeight};n.rect=X,n.width=+((B=e.width)!=null?B:X.width),n.height=+((W=e.height)!=null?W:X.height)}s.value&&(y=Math.min(s.value-1,y),y===-1&&(y=s.value-1)),n.active=y,n.swiping=!0,n.offset=O(y),S.forEach(X=>{X.setOffset(0)}),Y()};je(t)?me().then(_):_()},ee=()=>N(n.active);let oe;const m=y=>{!e.touchable||y.touches.length>1||(f.start(y),v=!1,oe=Date.now(),E(),r())},k=y=>{e.touchable&&n.swiping&&(f.move(y),w.value&&(!e.loop&&(n.active===0&&g.value>0||n.active===s.value-1&&g.value<0)||(ve(y,e.stopPropagation),R({offset:g.value}),v||(a("dragStart",{index:c.value}),v=!0))))},I=()=>{if(!e.touchable||!n.swiping)return;const y=Date.now()-oe,_=g.value/y;if((Math.abs(_)>.25||Math.abs(g.value)>u.value/2)&&w.value){const W=e.vertical?f.offsetY.value:f.offsetX.value;let X=0;e.loop?X=W>0?g.value>0?-1:1:0:X=-Math[g.value>0?"ceil":"floor"](g.value/u.value),R({pace:X,emitChange:!0})}else g.value&&R({pace:0});v=!1,n.swiping=!1,a("dragEnd",{index:c.value}),Y()},M=(y,_={})=>{r(),f.reset(),pe(()=>{let B;e.loop&&y===s.value?B=n.active===0?0:y:B=y%s.value,_.immediate?pe(()=>{n.swiping=!1}):n.swiping=!1,R({pace:B-n.active,emitChange:!0})})},j=(y,_)=>{const B=_===c.value,W=B?{backgroundColor:e.indicatorColor}:void 0;return d("i",{style:W,class:ke("indicator",{active:B})},null)},H=()=>{if(o.indicator)return o.indicator({active:c.value,total:s.value});if(e.showIndicators&&s.value>1)return d("div",{class:ke("indicators",{vertical:e.vertical})},[Array(s.value).fill("").map(j)])};return he({prev:C,next:x,state:n,resize:ee,swipeTo:M}),b({size:u,props:e,count:s,activeIndicator:c}),V(()=>e.initialSwipe,y=>N(+y)),V(s,()=>N(n.active)),V(()=>e.autoplay,Y),V([at,ot,()=>e.width,()=>e.height],ee),V(Pt(),y=>{y==="visible"?Y():E()}),ge(N),et(()=>N(n.active)),Ot(()=>N(n.active)),Ue(E),Oe(E),Te("touchmove",k,{target:l}),()=>{var y;return d("div",{ref:t,class:ke()},[d("div",{ref:l,style:p.value,class:ke("track",{vertical:e.vertical}),onTouchstartPassive:m,onTouchend:I,onTouchcancel:I},[(y=o.default)==null?void 0:y.call(o)]),H()])}}});const ia=ae(la),[sa,ra]=Q("swipe-item");var ca=Z({name:sa,setup(e,{slots:a}){let o;const t=ne({offset:0,inited:!1,mounted:!1}),{parent:l,index:n}=Tt(dt);if(!l)return;const v=U(()=>{const b={},{vertical:s}=l.props;return l.size.value&&(b[s?"height":"width"]=`${l.size.value}px`),t.offset&&(b.transform=`translate${s?"Y":"X"}(${t.offset}px)`),b}),f=U(()=>{const{loop:b,lazyRender:s}=l.props;if(!s||o)return!0;if(!t.mounted)return!1;const u=l.activeIndicator.value,g=l.count.value-1,i=u===0&&b?g:u-1,h=u===g&&b?0:u+1;return o=n.value===u||n.value===i||n.value===h,o}),S=b=>{t.offset=b};return ge(()=>{me(()=>{t.mounted=!0})}),he({setOffset:S}),()=>{var b;return d("div",{class:ra(),style:v.value},[f.value?(b=a.default)==null?void 0:b.call(a):null])}}});const ua=ae(ca);let be=0;function da(e){e?(be||document.body.classList.add("van-toast--unclickable"),be++):be&&(be--,be||document.body.classList.remove("van-toast--unclickable"))}const[va,ie]=Q("toast"),fa=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],ma={icon:String,show:Boolean,type:$("text"),overlay:Boolean,message:F,iconSize:F,duration:_t(2e3),position:$("middle"),teleport:[String,Object],wordBreak:String,className:fe,iconPrefix:String,transition:$("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:fe,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var vt=Z({name:va,props:ma,emits:["update:show"],setup(e,{emit:a,slots:o}){let t,l=!1;const n=()=>{const u=e.show&&e.forbidClick;l!==u&&(l=u,da(l))},v=u=>a("update:show",u),f=()=>{e.closeOnClick&&v(!1)},S=()=>clearTimeout(t),b=()=>{const{icon:u,type:g,iconSize:i,iconPrefix:h,loadingType:A}=e;if(u||g==="success"||g==="fail")return d(q,{name:u||g,size:i,class:ie("icon"),classPrefix:h},null);if(g==="loading")return d(Me,{class:ie("loading"),size:i,type:A},null)},s=()=>{const{type:u,message:g}=e;if(o.message)return d("div",{class:ie("text")},[o.message()]);if(Ae(g)&&g!=="")return u==="html"?d("div",{key:0,class:ie("text"),innerHTML:String(g)},null):d("div",{class:ie("text")},[g])};return V(()=>[e.show,e.forbidClick],n),V(()=>[e.show,e.type,e.message,e.duration],()=>{S(),e.show&&e.duration>0&&(t=setTimeout(()=>{v(!1)},e.duration))}),ge(n),Rt(n),()=>d(ct,te({class:[ie([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:f,onClosed:S,"onUpdate:show":v},de(e,fa)),{default:()=>[b(),s()]})}});function ft(){const e=ne({show:!1}),a=l=>{e.show=l},o=l=>{K(e,l,{transitionAppear:!0}),a(!0)},t=()=>a(!1);return he({open:o,close:t,toggle:a}),{open:o,close:t,state:e,toggle:a}}function mt(e){const a=Dt(e),o=document.createElement("div");return document.body.appendChild(o),{instance:a.mount(o),unmount(){a.unmount(),document.body.removeChild(o)}}}const ga={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let Ie=[],ha=!1,He=K({},ga);const wa=new Map;function ya(e){return Bt(e)?e:{message:e}}function ba(){const{instance:e,unmount:a}=mt({setup(){const o=z(""),{open:t,state:l,close:n,toggle:v}=ft(),f=()=>{},S=()=>d(vt,te(l,{onClosed:f,"onUpdate:show":v}),null);return V(o,b=>{l.message=b}),Le().render=S,{open:t,close:n,message:o}}});return e}function Sa(){if(!Ie.length||ha){const e=ba();Ie.push(e)}return Ie[Ie.length-1]}function Ge(e={}){if(!Ee)return{};const a=Sa(),o=ya(e);return a.open(K({},He,wa.get(o.type||He.type),o)),a}ae(vt);const[Ca,se]=Q("image"),Aa={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:F,height:F,radius:F,lazyLoad:Boolean,iconSize:F,showError:D,errorIcon:$("photo-fail"),iconPrefix:String,showLoading:D,loadingIcon:$("photo")};var pa=Z({name:Ca,props:Aa,emits:["load","error"],setup(e,{emit:a,slots:o}){const t=z(!1),l=z(!0),n=z(),{$Lazyload:v}=Le().proxy,f=U(()=>{const c={width:_e(e.width),height:_e(e.height)};return Ae(e.radius)&&(c.overflow="hidden",c.borderRadius=_e(e.radius)),c});V(()=>e.src,()=>{t.value=!1,l.value=!0});const S=c=>{l.value&&(l.value=!1,a("load",c))},b=()=>{const c=new Event("load");Object.defineProperty(c,"target",{value:n.value,enumerable:!0}),S(c)},s=c=>{t.value=!0,l.value=!1,a("error",c)},u=(c,w,p)=>p?p():d(q,{name:c,size:e.iconSize,class:w,classPrefix:e.iconPrefix},null),g=()=>{if(l.value&&e.showLoading)return d("div",{class:se("loading")},[u(e.loadingIcon,se("loading-icon"),o.loading)]);if(t.value&&e.showError)return d("div",{class:se("error")},[u(e.errorIcon,se("error-icon"),o.error)])},i=()=>{if(t.value||!e.src)return;const c={alt:e.alt,class:se("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?Ce(d("img",te({ref:n},c),null),[[Lt("lazy"),e.src]]):d("img",te({ref:n,src:e.src,onLoad:S,onError:s},c),null)},h=({el:c})=>{const w=()=>{c===n.value&&l.value&&b()};n.value?w():me(w)},A=({el:c})=>{c===n.value&&!t.value&&s()};return v&&Ee&&(v.$on("loaded",h),v.$on("error",A),Oe(()=>{v.$off("loaded",h),v.$off("error",A)})),ge(()=>{me(()=>{var c;(c=n.value)!=null&&c.complete&&!e.lazyLoad&&b()})}),()=>{var c;return d("div",{class:se({round:e.round,block:e.block}),style:f.value},[i(),g(),(c=o.default)==null?void 0:c.call(o)])}}});const gt=ae(pa),Ke=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),ka=e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}),De=Q("image-preview")[1],Je=2.6;var Ia=Z({props:{src:String,show:Boolean,active:Number,minZoom:Se(F),maxZoom:Se(F),rootWidth:Se(Number),rootHeight:Se(Number),disableZoom:Boolean,closeOnClickOverlay:Boolean},emits:["scale","close","longPress"],setup(e,{emit:a,slots:o}){const t=ne({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),l=Ye(),n=z(),v=z(),f=z(!1),S=z(!1);let b=0;const s=U(()=>{const{scale:m,moveX:k,moveY:I,moving:M,zooming:j,initializing:H}=t,y={transitionDuration:j||M||H?"0s":".3s"};return(m!==1||S.value)&&(y.transform=`matrix(${m}, 0, 0, ${m}, ${k}, ${I})`),y}),u=U(()=>{if(t.imageRatio){const{rootWidth:m,rootHeight:k}=e,I=f.value?k/t.imageRatio:m;return Math.max(0,(t.scale*I-m)/2)}return 0}),g=U(()=>{if(t.imageRatio){const{rootWidth:m,rootHeight:k}=e,I=f.value?k:m*t.imageRatio;return Math.max(0,(t.scale*I-k)/2)}return 0}),i=(m,k)=>{var I;if(m=G(m,+e.minZoom,+e.maxZoom+1),m!==t.scale){const M=m/t.scale;if(t.scale=m,k){const j=nt((I=n.value)==null?void 0:I.$el),H={x:j.width*.5,y:j.height*.5},y=t.moveX-(k.x-j.left-H.x)*(M-1),_=t.moveY-(k.y-j.top-H.y)*(M-1);t.moveX=G(y,-u.value,u.value),t.moveY=G(_,-g.value,g.value)}else t.moveX=0,t.moveY=S.value?b:0;a("scale",{scale:m,index:e.active})}},h=()=>{i(1)},A=()=>{const m=t.scale>1?1:2;i(m,m===2||S.value?{x:l.startX.value,y:l.startY.value}:void 0)};let c,w,p,T,O,R,r,C,x=!1;const P=m=>{const{touches:k}=m;if(c=k.length,c===2&&e.disableZoom)return;const{offsetX:I}=l;l.start(m),w=t.moveX,p=t.moveY,C=Date.now(),x=!1,t.moving=c===1&&(t.scale!==1||S.value),t.zooming=c===2&&!I.value,t.zooming&&(T=t.scale,O=Ke(k))},E=m=>{const{touches:k}=m;if(l.move(m),t.moving){const{deltaX:I,deltaY:M}=l,j=I.value+w,H=M.value+p;if((j>u.value||j<-u.value)&&!x&&l.isHorizontal()){t.moving=!1;return}x=!0,ve(m,!0),t.moveX=G(j,-u.value,u.value),t.moveY=G(H,-g.value,g.value)}if(t.zooming&&(ve(m,!0),k.length===2)){const I=Ke(k),M=T*I/O;R=ka(k),i(M,R)}},Y=m=>{var k;if(c>1)return;const{offsetX:I,offsetY:M}=l,j=Date.now()-C,H=250;if(I.value<xe&&M.value<xe)if(j<H)if(r)clearTimeout(r),r=null,A();else{if(!e.closeOnClickOverlay&&m.target===((k=v.value)==null?void 0:k.$el))return;r=setTimeout(()=>{a("close"),r=null},H)}else j>Vt&&a("longPress")},N=m=>{let k=!1;if((t.moving||t.zooming)&&(k=!0,t.moving&&w===t.moveX&&p===t.moveY&&(k=!1),!m.touches.length)){t.zooming&&(t.moveX=G(t.moveX,-u.value,u.value),t.moveY=G(t.moveY,-g.value,g.value),t.zooming=!1),t.moving=!1,w=0,p=0,T=1,t.scale<1&&h();const I=+e.maxZoom;t.scale>I&&i(I,R)}ve(m,k),Y(m),l.reset()},ee=()=>{const{rootWidth:m,rootHeight:k}=e,I=k/m,{imageRatio:M}=t;f.value=t.imageRatio>I&&M<Je,S.value=t.imageRatio>I&&M>=Je,S.value&&(b=(M*m-k)/2,t.moveY=b,t.initializing=!0,Ut(()=>{t.initializing=!1})),h()},oe=m=>{const{naturalWidth:k,naturalHeight:I}=m.target;t.imageRatio=I/k,ee()};return V(()=>e.active,h),V(()=>e.show,m=>{m||h()}),V(()=>[e.rootWidth,e.rootHeight],ee),Te("touchmove",E,{target:U(()=>{var m;return(m=v.value)==null?void 0:m.$el})}),()=>{const m={loading:()=>d(Me,{type:"spinner"},null)};return d(ua,{ref:v,class:De("swipe-item"),onTouchstartPassive:P,onTouchend:N,onTouchcancel:N},{default:()=>[o.image?d("div",{class:De("image-wrap")},[o.image({src:e.src})]):d(gt,{ref:n,src:e.src,fit:"contain",class:De("image",{vertical:f.value}),style:s.value,onLoad:oe},m)]})}}});const[za,re]=Q("image-preview"),xa=["show","teleport","transition","overlayStyle","closeOnPopstate"],Pa={show:Boolean,loop:D,images:lt(),minZoom:J(1/3),maxZoom:J(3),overlay:D,closeable:Boolean,showIndex:D,className:fe,closeIcon:$("clear"),transition:String,beforeClose:Function,overlayClass:fe,overlayStyle:Object,swipeDuration:J(300),startPosition:J(0),showIndicators:Boolean,closeOnPopstate:D,closeOnClickOverlay:D,closeIconPosition:$("top-right"),teleport:[String,Object]};var ht=Z({name:za,props:Pa,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:a,slots:o}){const t=z(),l=ne({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),n=()=>{if(t.value){const p=nt(t.value.$el);l.rootWidth=p.width,l.rootHeight=p.height,t.value.resize()}},v=p=>a("scale",p),f=p=>a("update:show",p),S=()=>{Ve(e.beforeClose,{args:[l.active],done:()=>f(!1)})},b=p=>{p!==l.active&&(l.active=p,a("change",p))},s=()=>{if(e.showIndex)return d("div",{class:re("index")},[o.index?o.index({index:l.active}):`${l.active+1} / ${e.images.length}`])},u=()=>{if(o.cover)return d("div",{class:re("cover")},[o.cover()])},g=()=>{l.disableZoom=!0},i=()=>{l.disableZoom=!1},h=()=>d(ia,{ref:t,lazyRender:!0,loop:e.loop,class:re("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:b,onDragEnd:i,onDragStart:g},{default:()=>[e.images.map((p,T)=>d(Ia,{src:p,show:e.show,active:l.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:l.rootWidth,rootHeight:l.rootHeight,disableZoom:l.disableZoom,closeOnClickOverlay:e.closeOnClickOverlay,onScale:v,onClose:S,onLongPress:()=>a("longPress",{index:T})},{image:o.image}))]}),A=()=>{if(e.closeable)return d(q,{role:"button",name:e.closeIcon,class:[re("close-icon",e.closeIconPosition),tt],onClick:S},null)},c=()=>a("closed"),w=(p,T)=>{var O;return(O=t.value)==null?void 0:O.swipeTo(p,T)};return he({swipeTo:w}),ge(n),V([at,ot],n),V(()=>e.startPosition,p=>b(+p)),V(()=>e.show,p=>{const{images:T,startPosition:O}=e;p?(b(+O),me(()=>{n(),w(+O,{immediate:!0})})):a("close",{index:l.active,url:T[l.active]})}),()=>d(ct,te({class:[re(),e.className],overlayClass:[re("overlay"),e.overlayClass],onClosed:c,"onUpdate:show":f},de(e,xa)),{default:()=>[A(),h(),s(),u()]})}});let ze;const Oa={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function Ta(){({instance:ze}=mt({setup(){const{state:e,toggle:a}=ft(),o=()=>{e.images=[]};return()=>d(ht,te(e,{onClosed:o,"onUpdate:show":a}),null)}}))}const wt=(e,a=0)=>{if(Ee)return ze||Ta(),e=Array.isArray(e)?{images:e,startPosition:a}:e,ze.open(K({},Oa,e)),ze};ae(ht);const[Ra,L,_a]=Q("uploader");function qe(e,a){return new Promise(o=>{if(a==="file"){o();return}const t=new FileReader;t.onload=l=>{o(l.target.result)},a==="dataUrl"?t.readAsDataURL(e):a==="text"&&t.readAsText(e)})}function yt(e,a){return it(e).some(o=>o.file?Et(a)?a(o.file):o.file.size>+a:!1)}function Da(e,a){const o=[],t=[];return e.forEach(l=>{yt(l,a)?t.push(l):o.push(l)}),{valid:o,invalid:t}}const Ba=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,La=e=>Ba.test(e);function bt(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?La(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var Ua=Z({props:{name:F,item:Se(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:a,slots:o}){const t=()=>{const{status:s,message:u}=e.item;if(s==="uploading"||s==="failed"){const g=s==="failed"?d(q,{name:"close",class:L("mask-icon")},null):d(Me,{class:L("loading")},null),i=Ae(u)&&u!=="";return d("div",{class:L("mask")},[g,i&&d("div",{class:L("mask-message")},[u])])}},l=s=>{const{name:u,item:g,index:i,beforeDelete:h}=e;s.stopPropagation(),Ve(h,{args:[g,{name:u,index:i}],done:()=>a("delete")})},n=()=>a("preview"),v=()=>a("reupload"),f=()=>{if(e.deletable&&e.item.status!=="uploading"){const s=o["preview-delete"];return d("div",{role:"button",class:L("preview-delete",{shadow:!s}),tabindex:0,"aria-label":_a("delete"),onClick:l},[s?s():d(q,{name:"cross",class:L("preview-delete-icon")},null)])}},S=()=>{if(o["preview-cover"]){const{index:s,item:u}=e;return d("div",{class:L("preview-cover")},[o["preview-cover"](K({index:s},u))])}},b=()=>{const{item:s,lazyLoad:u,imageFit:g,previewSize:i,reupload:h}=e;return bt(s)?d(gt,{fit:g,src:s.objectUrl||s.content||s.url,class:L("preview-image"),width:Array.isArray(i)?i[0]:i,height:Array.isArray(i)?i[1]:i,lazyLoad:u,onClick:h?v:n},{default:S}):d("div",{class:L("file"),style:st(e.previewSize)},[d(q,{class:L("file-icon"),name:"description"},null),d("div",{class:[L("file-name"),"van-ellipsis"]},[s.file?s.file.name:s.url]),S()])};return()=>d("div",{class:L("preview")},[b(),t(),f()])}});const Va={name:J(""),accept:$("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:J(1/0),imageFit:$("cover"),resultType:$("dataUrl"),uploadIcon:$("photograph"),uploadText:String,deletable:D,reupload:Boolean,afterRead:Function,showUpload:D,modelValue:lt(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:D,previewOptions:Object,previewFullImage:D,maxSize:{type:[Number,String,Function],default:1/0}};var Ea=Z({name:Ra,props:Va,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:a,slots:o}){const t=z(),l=[],n=z(-1),v=(r=e.modelValue.length)=>({name:e.name,index:r}),f=()=>{t.value&&(t.value.value="")},S=r=>{if(f(),yt(r,e.maxSize))if(Array.isArray(r)){const C=Da(r,e.maxSize);if(r=C.valid,a("oversize",C.invalid,v()),!r.length)return}else{a("oversize",r,v());return}if(r=ne(r),n.value>-1){const C=[...e.modelValue];C.splice(n.value,1,r),a("update:modelValue",C),n.value=-1}else a("update:modelValue",[...e.modelValue,...it(r)]);e.afterRead&&e.afterRead(r,v())},b=r=>{const{maxCount:C,modelValue:x,resultType:P}=e;if(Array.isArray(r)){const E=+C-x.length;r.length>E&&(r=r.slice(0,E)),Promise.all(r.map(Y=>qe(Y,P))).then(Y=>{const N=r.map((ee,oe)=>{const m={file:ee,status:"",message:"",objectUrl:URL.createObjectURL(ee)};return Y[oe]&&(m.content=Y[oe]),m});S(N)})}else qe(r,P).then(E=>{const Y={file:r,status:"",message:"",objectUrl:URL.createObjectURL(r)};E&&(Y.content=E),S(Y)})},s=r=>{const{files:C}=r.target;if(e.disabled||!C||!C.length)return;const x=C.length===1?C[0]:[].slice.call(C);if(e.beforeRead){const P=e.beforeRead(x,v());if(!P){f();return}if(Yt(P)){P.then(E=>{b(E||x)}).catch(f);return}}b(x)};let u;const g=()=>a("closePreview"),i=r=>{if(e.previewFullImage){const C=e.modelValue.filter(bt),x=C.map(P=>(P.objectUrl&&!P.url&&P.status!=="failed"&&(P.url=P.objectUrl,l.push(P.url)),P.url)).filter(Boolean);u=wt(K({images:x,startPosition:C.indexOf(r),onClose:g},e.previewOptions))}},h=()=>{u&&u.close()},A=(r,C)=>{const x=e.modelValue.slice(0);x.splice(C,1),a("update:modelValue",x),a("delete",r,v(C))},c=r=>{R(),n.value=r},w=(r,C)=>{const x=["imageFit","deletable","reupload","previewSize","beforeDelete"],P=K(de(e,x),de(r,x,!0));return d(Ua,te({item:r,index:C,onClick:()=>a(e.reupload?"clickReupload":"clickPreview",r,v(C)),onDelete:()=>A(r,C),onPreview:()=>i(r),onReupload:()=>c(C)},de(e,["name","lazyLoad"]),P),de(o,["preview-cover","preview-delete"]))},p=()=>{if(e.previewImage)return e.modelValue.map(w)},T=r=>a("clickUpload",r),O=()=>{if(e.modelValue.length>=+e.maxCount&&!e.reupload)return;const r=e.modelValue.length>=+e.maxCount&&e.reupload,C=e.readonly?null:d("input",{ref:t,type:"file",class:L("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&n.value===-1,disabled:e.disabled,onChange:s},null);return o.default?Ce(d("div",{class:L("input-wrapper"),onClick:T},[o.default(),C]),[[Pe,!r]]):Ce(d("div",{class:L("upload",{readonly:e.readonly}),style:st(e.previewSize),onClick:T},[d(q,{name:e.uploadIcon,class:L("upload-icon")},null),e.uploadText&&d("span",{class:L("upload-text")},[e.uploadText]),C]),[[Pe,e.showUpload&&!r]])},R=()=>{t.value&&!e.disabled&&t.value.click()};return Oe(()=>{l.forEach(r=>URL.revokeObjectURL(r))}),he({chooseFile:R,closeImagePreview:h}),Mt(()=>e.modelValue),()=>d("div",{class:L()},[d("div",{class:L("wrapper",{disabled:e.disabled})},[p(),O()])])}});const Ma=ae(Ea);const Ya="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAASFJREFUWEftl7FKxEAQhv+xSGWheGAeQQvhrHwDa6tUluKQMpWFjb7FDpeAIJY+gLWlha2NryDXSAwkGTm4yHF4cOtc56Rc9v8Yfr5dNgTDV5blcdd1DwD2+76/zPP80YADWcIi8gTgdM74YOY9C886zCuA8TAAM5t4prCI+DC/quDNrDoh3ow3E3t7ujP/15kQwhWAg1hniOgMwM6QU9W7WAaAaV3Xt0VRTGlZwj/ANhH5SpJkdzaMboJmZajqmEII90R0boUZ8y/MfDJ7z1BVVdtt227FAlX1mYiOFnI//qzLappG0zT9zLKs88fVqta8GW9m3RM17HNn3Bl3xn/8lx0QkQmAi/n6GzMfxnqyuN96z4wAXKvqiIhumPndMsw31ZOxAXvVCIsAAAAASUVORK5CYII=",ja="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAAAAXNSR0IArs4c6QAABJ1JREFUWEe1mH9MlVUYxz/n3mtIQWOzpJYuylZR1lz+YaEWVozKZC0qHLhklcI/aoWVQatbTWQOVlZbiq7QwFkOV2bFkhGZZbVZzNhYbQaNtcJwYlBE3ntPe8697+3l5d77Xtjl/QvuOe85n/f7/DjPcxSTeLTWc4BCYAmwAMgBsiJLDAK/A13AUeCQUurXZJdXyUzUWt8GbATuAnzJvBOZcwioV0p97vZOQhCt9VXAm8CdslAgqPmiW/NVj+bkb5reATj7V3iLWZkwOwtuyFHkXadYdI0ibUZ0eQFap5TqiwcUF0RrXQZsBzKG/9a0dGr2doYYGXX7tvB4Rjo8sFjx8B0esjLMNv8AlUqp3bFWiAmitX4B8MsLB78OUX8geQDnJqLUxmIPhQs91pBfKfWic94EEAtCzFD7boj3j+nkJHCZVbxYGaCIuSbAjAPRWq8GmsbOaZ7cGeRYT0oYoovk5cKrFT58XvPTKqVUizUYBdFaSyjK1jM37wvS+mVqlHB+yn23KJ4vNSQjkgKUUiflHzvIh8C9bcdDVDeFUiuFYzV/mYeim43PtCulCqIgkTzReWZE81BtkNPD08phIuojv5fM840O+ZJnzF9aa6PGax8EaWqfHpM4P23t3R4q7zGqSAZeoSJpu18ctKAm6Jonrr4M+gdhdCy2apnpMOtC6BtIrKqo0rHFOG5AjgoBqZDEdaQ7xOM7EvtGTjYceM5H74Bm7baJJhSAxvVershWrKwL8JPLSdOwxsOyG40qjwnIOxJKdfuDvHcksVnkK3ZXhTdywtghZGzV1iCj/yZWRXJLzUoTQU0C8gMwv2xrgJ5+dyeVTNm4YTyMxJ6lRDy1Yq284Ep46wlzhnYJyB/ARQXVgaSjxQkjK8VSye2zsi6AjjoDMiQgxh43rROfSf6xw8hbk1HCvst3r4eriqmD2BwzVSBnpMpatikQrS3cdHE65lRNI6oerjWKDIoi30vOf+SVAF0/uyGEc4TTMeUtpwMnk51z50LL0wakW0DeBsqTOejS06D5qTjh64im1Q3uybHkVsUzD5rwbRaQR4Fdn50IUbUzcUKTrLpvU4KEZoO5/+UAfacSK7ytwsPS+SahVVopvjcQxHf7swHXFJ8zGwaHiTsv/TyYezGuWVWOgk83+0ibYWDnjDv0tn8covGT6S0BLI3KCzysL7IdejJglQFSJC/3u9vW3aUTz5Bo2V/ttYrq/8uACMxhaRsOfhPC3zy9qmwp91K40BjDlAAmoVnsWut5kS4t46W9wZQVzU5tipcoakpMpEh7ca1S6pdxIBFVpJdpDgRhww4pnlNbJOXlKhrWeC0HLbf3OHHbibFzUN+auiJaiubqEq9VwSduJ2xmijZYbcc1Da1Tr2MlTKuKPRQtmmSDZYORHkdazplDI5o9HZrWoyGGk2w5BaA030NpvrKKZGkfpOWM9jJ2/3Frwi8H3pDCWl4Sc337ozThIU70ak6dhdN/hpeT2iInWzHvUkwTvvR6j2UGGW6PQJgeJtYz2WsJA5TkIwVOW0quJZwbRir+5baLmkukuovMGwLk2sG6qGmbzEXNf6R4GNnnBuYHAAAAAElFTkSuQmCC",Fa=["src","onClick"],$a={key:1,controls:"",class:"upload-image"},Xa=["src"],Wa=["src"],Za=["onClick"],Na={class:"upload-empty"},Ha={class:"empty-box"},Ga={class:"empty-text"},Ka=Z({__name:"index",props:{fileStr:{default:""},isPreview:{type:Boolean,default:!1},emptyTitle:{default:"上传"},limit:{default:9},fileSize:{default:12},fileType:{default:()=>["image/jpeg","image/jpg","image/png","image/gif"]},isUploadVideo:{type:Boolean,default:!1},height:{default:90},width:{default:90},margin:{default:8},borderRadius:{default:8}},emits:["update:fileStr"],setup(e,{emit:a}){const o=e,t=U(()=>{const i=["video/mp4","video/m2v","video/mkv","video/mov","video/3gp","video/quicktime"];return o.isUploadVideo?o.fileType.concat(i):o.fileType}),l=U(()=>{const i=h=>`${h/375*100}vw`;return{"--width":i(o.width),"--height":i(o.height),"--borderRadius":i(o.borderRadius),"--margin":i(o.margin)}}),n=z([]),v=["png","jpg","jpeg","bmp","gif"],f=["mp4","m2v","mkv","mov","3gp"];function S(i=""){var A;const h=((A=i.split(".").pop())==null?void 0:A.toLocaleLowerCase())||"";return v.includes(h)?"image":f.includes(h)?"video":""}function b(i){const h=Array.isArray(i)?i:[i],A=n.value.length,c=h.slice(0,o.limit-A).map(w=>new Promise((p,T)=>{const{size:O,type:R}=w;O/1024/1024>o.fileSize&&(Ge(`上传图片大小不能超过 ${o.fileSize}M！`),T(new Error(`上传图片大小不能超过 ${o.fileSize}M！`))),t.value.includes(R.toLocaleLowerCase())||(Ge("上传文件不符合所需的格式！"),T(new Error("上传文件不符合所需的格式！"))),p(w)}));return Promise.all(c)}async function s(i){const A=i.map(c=>({...c})).map((c,w)=>new Promise(async(p,T)=>{try{i[w].status="uploading",i[w].message="上传中...";const O=new FormData;O.append("file",c.file),O.append("module","efficacy"),O.append("category","track"),O.append("async","false");const{data:{absoluteUrl:R}}=await Promise.resolve({data:{absoluteUrl:"https://fastly.jsdelivr.net/npm/@vant/assets/leaf.jpeg"}});i[w].status="done",i[w].message="上传成功",i[w].url=R,p({absoluteUrl:R})}catch(O){console.log(O),i[w].status="failed",i[w].message="上传失败",T(new Error("上传失败"))}}));try{await Promise.all(A)}catch{a("update:fileStr","")}finally{const c=n.value.filter(w=>!!w.url).map(w=>w.url).join(",");a("update:fileStr",c)}}function u(i){const h=n.value.filter(A=>A.url!==i).map(A=>A.url).join(",");a("update:fileStr",h)}function g(i){let h=-1;const A=n.value.map((c,w)=>(c.url===i&&(h=w),c.url));wt({images:A,startPosition:h})}return V(()=>o.fileStr,i=>{const h=(i?i.split(","):[]).map(A=>({url:A,status:"done",message:"上传成功"}));n.value=h},{immediate:!0}),(i,h)=>{const A=q,c=Ma;return ce(),ue("div",null,[d(c,{modelValue:n.value,"onUpdate:modelValue":h[0]||(h[0]=w=>n.value=w),multiple:o.limit!==1,"max-count":o.limit,accept:t.value.join(","),"before-read":b,"after-read":s,deletable:!1,class:$t(i.isPreview?"preview-class":""),style:Xt(l.value)},{"preview-cover":Fe(({url:w,status:p})=>[p!=="done"?(ce(),ue(Be,{key:0},[],64)):(ce(),ue(Be,{key:1},[S(w)==="image"?(ce(),ue("img",{key:0,src:w,class:"upload-image",onClick:$e(T=>g(w),["stop"])},null,8,Fa)):Xe("",!0),S(w)==="video"?(ce(),ue("video",$a,[le("source",{src:w,type:"video/mp4"},null,8,Xa),le("source",{src:w,type:"video/ogg"},null,8,Wa),jt(" 您的浏览器不支持Video标签。 ")])):Xe("",!0)],64)),le("div",{class:"delete-box",onClick:$e(T=>u(w),["stop"])},[d(A,{name:We(ja),size:"4.5vw"},null,8,["name"])],8,Za)]),default:Fe(()=>[le("div",Na,[Ft(i.$slots,"empty",{},()=>[le("div",Ha,[d(A,{name:We(Ya),size:"4vw"},null,8,["name"]),le("div",Ga,Wt(i.emptyTitle),1)])],!0)])]),_:3},8,["modelValue","multiple","max-count","accept","after-read","class","style"])])}}});const Ja=Zt(Ka,[["__scopeId","data-v-ee7ca9d2"]]),qa={class:"page-wrapper",style:{padding:"20px",background:"rgb(97, 18, 109)"}},to=Z({__name:"component",setup(e){const a=ne({fileStr:""});return(o,t)=>(ce(),ue("div",qa,[d(Ja,{"file-str":a.fileStr,"onUpdate:fileStr":t[0]||(t[0]=l=>a.fileStr=l)},null,8,["file-str"])]))}});export{to as default};
